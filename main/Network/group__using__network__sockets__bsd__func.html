<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network Component: User API</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "Network Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__using__network__sockets__bsd__func.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">User API<div class="ingroups"><a class="el" href="group__netSockets.html">Sockets</a> &raquo; <a class="el" href="group__netBSD__Func.html">BSD Socket</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>BSD Socket functions and communication flow.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac01ac0611ef0f7d743e0eb464e7786a9"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> (int32_t family, int32_t type, int32_t protocol)</td></tr>
<tr class="memdesc:gac01ac0611ef0f7d743e0eb464e7786a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a communication endpoint called socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gac01ac0611ef0f7d743e0eb464e7786a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga371b442b92e67a6046b168521d4a1b4a"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a">bind</a> (int32_t sock, const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *addr, int32_t addrlen)</td></tr>
<tr class="memdesc:ga371b442b92e67a6046b168521d4a1b4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign a local address and port to a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga371b442b92e67a6046b168521d4a1b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4dde9362ae7fd2b2a60eeba388874afa"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa">listen</a> (int32_t sock, int32_t backlog)</td></tr>
<tr class="memdesc:ga4dde9362ae7fd2b2a60eeba388874afa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set a socket in a listening mode. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga4dde9362ae7fd2b2a60eeba388874afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34f0c4489df12e0ce4972a78ec3d62b4"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4">accept</a> (int32_t sock, <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *addr, int32_t *addrlen)</td></tr>
<tr class="memdesc:ga34f0c4489df12e0ce4972a78ec3d62b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept connect request for a listening socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga34f0c4489df12e0ce4972a78ec3d62b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9feed17ea4fc7449b8159eabc131ed5b"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b">connect</a> (int32_t sock, const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *addr, int32_t addrlen)</td></tr>
<tr class="memdesc:ga9feed17ea4fc7449b8159eabc131ed5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Connect a socket to a remote host. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga9feed17ea4fc7449b8159eabc131ed5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4cc5678cb81694afc224221063fda9cd"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4cc5678cb81694afc224221063fda9cd">send</a> (int32_t sock, const char *buf, int32_t len, int32_t flags)</td></tr>
<tr class="memdesc:ga4cc5678cb81694afc224221063fda9cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data on already connected socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga4cc5678cb81694afc224221063fda9cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9207ae37f46c2999ac5765fc6736535"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gab9207ae37f46c2999ac5765fc6736535">sendto</a> (int32_t sock, const char *buf, int32_t len, int32_t flags, const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *to, int32_t tolen)</td></tr>
<tr class="memdesc:gab9207ae37f46c2999ac5765fc6736535"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data to endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gab9207ae37f46c2999ac5765fc6736535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a77bd5e326e02dbc9c2f07684f8c4ff"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga7a77bd5e326e02dbc9c2f07684f8c4ff">sendmsg</a> (int32_t sock, const <a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> *msg, int32_t flags)</td></tr>
<tr class="memdesc:ga7a77bd5e326e02dbc9c2f07684f8c4ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a message to endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga7a77bd5e326e02dbc9c2f07684f8c4ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6d5bc55c3bcbed83a0e03eae48010ba"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba">recv</a> (int32_t sock, char *buf, int32_t len, int32_t flags)</td></tr>
<tr class="memdesc:gaf6d5bc55c3bcbed83a0e03eae48010ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data on already connected socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gaf6d5bc55c3bcbed83a0e03eae48010ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafe47bf7123d59a831e0f337bd283872"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gaafe47bf7123d59a831e0f337bd283872">recvfrom</a> (int32_t sock, char *buf, int32_t len, int32_t flags, <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *from, int32_t *fromlen)</td></tr>
<tr class="memdesc:gaafe47bf7123d59a831e0f337bd283872"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gaafe47bf7123d59a831e0f337bd283872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga931d8f601c812a4497fc9e00f7e11936"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga931d8f601c812a4497fc9e00f7e11936">recvmsg</a> (int32_t sock, <a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> *msg, int32_t flags)</td></tr>
<tr class="memdesc:ga931d8f601c812a4497fc9e00f7e11936"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive a message from a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga931d8f601c812a4497fc9e00f7e11936"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50c4d62065c117f425ae2734e7979f21"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21">closesocket</a> (int32_t sock)</td></tr>
<tr class="memdesc:ga50c4d62065c117f425ae2734e7979f21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close socket and release socket descriptor. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga50c4d62065c117f425ae2734e7979f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4197286e9ca6483174462fe0cbdc5c67"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4197286e9ca6483174462fe0cbdc5c67">getpeername</a> (int32_t sock, <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *name, int32_t *namelen)</td></tr>
<tr class="memdesc:ga4197286e9ca6483174462fe0cbdc5c67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve IP address and port number of the endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga4197286e9ca6483174462fe0cbdc5c67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8cdaa88cc2ccc643495063e2dbe5cc5a"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga8cdaa88cc2ccc643495063e2dbe5cc5a">getsockname</a> (int32_t sock, <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *name, int32_t *namelen)</td></tr>
<tr class="memdesc:ga8cdaa88cc2ccc643495063e2dbe5cc5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve local IP address and port number. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga8cdaa88cc2ccc643495063e2dbe5cc5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8f69a56936f963ac8f9b9c74ae7e95bb"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga8f69a56936f963ac8f9b9c74ae7e95bb">ioctlsocket</a> (int32_t sock, long cmd, unsigned long *argp)</td></tr>
<tr class="memdesc:ga8f69a56936f963ac8f9b9c74ae7e95bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Control IO mode of a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga8f69a56936f963ac8f9b9c74ae7e95bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7a19e669b6bf6f4f82b68d01ff6d4be7"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7">setsockopt</a> (int32_t sock, int32_t level, int32_t optname, const char *optval, int32_t optlen)</td></tr>
<tr class="memdesc:ga7a19e669b6bf6f4f82b68d01ff6d4be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manipulate options for the socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga7a19e669b6bf6f4f82b68d01ff6d4be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bcdb9de12a6f30c3b404b9b54d74c1f"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga5bcdb9de12a6f30c3b404b9b54d74c1f">getsockopt</a> (int32_t sock, int32_t level, int32_t optname, char *optval, int32_t *optlen)</td></tr>
<tr class="memdesc:ga5bcdb9de12a6f30c3b404b9b54d74c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve options for the socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga5bcdb9de12a6f30c3b404b9b54d74c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54ae5d6756952f2844efec876e6290e9"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga54ae5d6756952f2844efec876e6290e9">select</a> (int32_t nfds, <a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *readfds, <a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *writefds, <a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *errorfds, const <a class="el" href="group__bsd__structs.html#structtimeval">timeval</a> *timeout)</td></tr>
<tr class="memdesc:ga54ae5d6756952f2844efec876e6290e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the status of one or more sockets. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga54ae5d6756952f2844efec876e6290e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga960a2fca6713ffbd8889a41f15e5c0ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__bsd__structs.html#structHOSTENT">HOSTENT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga960a2fca6713ffbd8889a41f15e5c0ac">gethostbyname</a> (const char *name, int32_t *err)</td></tr>
<tr class="memdesc:ga960a2fca6713ffbd8889a41f15e5c0ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve host IP address from host name. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga960a2fca6713ffbd8889a41f15e5c0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga57fbb43943b1a1226814c7acf881bf1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga57fbb43943b1a1226814c7acf881bf1c">inet_addr</a> (const char *cp)</td></tr>
<tr class="memdesc:ga57fbb43943b1a1226814c7acf881bf1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from text address to a network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga57fbb43943b1a1226814c7acf881bf1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada37f8d9ecd2195bcad7717a295d2ad2"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gada37f8d9ecd2195bcad7717a295d2ad2">inet_aton</a> (const char *cp, <a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a> *addr)</td></tr>
<tr class="memdesc:gada37f8d9ecd2195bcad7717a295d2ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from text address to a network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gada37f8d9ecd2195bcad7717a295d2ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9123668788ba0c48c7ee439f325e728a"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a">inet_ntoa</a> (<a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a> in)</td></tr>
<tr class="memdesc:ga9123668788ba0c48c7ee439f325e728a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from network address to a text string. [<a class="el" href="group__function__categories.html#not_thread-safe">not_thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga9123668788ba0c48c7ee439f325e728a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaadac07d29a87adfc6435582c989cdbc2"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#gaadac07d29a87adfc6435582c989cdbc2">inet_pton</a> (int32_t af, const char *src, void *dst)</td></tr>
<tr class="memdesc:gaadac07d29a87adfc6435582c989cdbc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from text address to a binary network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gaadac07d29a87adfc6435582c989cdbc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0bd214382fd14e4428076d88ced3748b"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__using__network__sockets__bsd__func.html#ga0bd214382fd14e4428076d88ced3748b">inet_ntop</a> (int32_t af, const void *src, char *dst, int32_t size)</td></tr>
<tr class="memdesc:ga0bd214382fd14e4428076d88ced3748b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert from binary network address to a text string. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga0bd214382fd14e4428076d88ced3748b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>BSD Socket functions and communication flow. </p>
<p>The following table shows the available API functions for BSD sockets.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4">accept</a>   </td><td class="markdownTableBodyNone">Accepts a connection request queued for a listening socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a">bind</a>   </td><td class="markdownTableBodyNone">Assigns a name (local address) to a socket.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21">closesocket</a>   </td><td class="markdownTableBodyNone">Closes an existing socket and releases a socket descriptor.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b">connect</a>   </td><td class="markdownTableBodyNone">Establishes connection between the endpoints on stream sockets.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga960a2fca6713ffbd8889a41f15e5c0ac">gethostbyname</a>   </td><td class="markdownTableBodyNone">Retrieves host address corresponding to a host name from a host database.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4197286e9ca6483174462fe0cbdc5c67">getpeername</a>   </td><td class="markdownTableBodyNone">Retrieves the address of the peer to which a socket is connected.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga5bcdb9de12a6f30c3b404b9b54d74c1f">getsockopt</a>   </td><td class="markdownTableBodyNone">Retrieves options for the socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga8cdaa88cc2ccc643495063e2dbe5cc5a">getsockname</a>   </td><td class="markdownTableBodyNone">Retrieves the local address of the socket.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga8f69a56936f963ac8f9b9c74ae7e95bb">ioctlsocket</a>   </td><td class="markdownTableBodyNone">Sets or retrieves some of the operating parameters on a socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa">listen</a>   </td><td class="markdownTableBodyNone">Sets the socket in a listen mode.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba">recv</a>   </td><td class="markdownTableBodyNone">Receives incoming data that has been queued for a socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gaafe47bf7123d59a831e0f337bd283872">recvfrom</a>   </td><td class="markdownTableBodyNone">Receives incoming data on a datagram socket.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga931d8f601c812a4497fc9e00f7e11936">recvmsg</a>   </td><td class="markdownTableBodyNone">Receives a message from a socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga54ae5d6756952f2844efec876e6290e9">select</a>   </td><td class="markdownTableBodyNone">Tests sockets if ready for reading, writing or have an error pending.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga4cc5678cb81694afc224221063fda9cd">send</a>   </td><td class="markdownTableBodyNone">Sends outgoing data on a socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gab9207ae37f46c2999ac5765fc6736535">sendto</a>   </td><td class="markdownTableBodyNone">Sends outgoing data on a datagram socket to destination address.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga7a77bd5e326e02dbc9c2f07684f8c4ff">sendmsg</a>   </td><td class="markdownTableBodyNone">Sends a message to destination address.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7">setsockopt</a>   </td><td class="markdownTableBodyNone">Manipulate options for the socket.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>   </td><td class="markdownTableBodyNone">Creates a communication socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga57fbb43943b1a1226814c7acf881bf1c">inet_addr</a>   </td><td class="markdownTableBodyNone">Converts address from text address to a network address.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gada37f8d9ecd2195bcad7717a295d2ad2">inet_aton</a>   </td><td class="markdownTableBodyNone">Converts address from text address to a network address.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a">inet_ntoa</a>   </td><td class="markdownTableBodyNone">Converts address from network address to a text string.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#gaadac07d29a87adfc6435582c989cdbc2">inet_pton</a>   </td><td class="markdownTableBodyNone">Converts address from text address to a binary network address.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__using__network__sockets__bsd__func.html#ga0bd214382fd14e4428076d88ced3748b">inet_ntop</a>   </td><td class="markdownTableBodyNone">Converts address from binary network address to a text string.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>The BSD sockets implementation in the Network Component is not a complete implementation of the BSD API.</li>
<li>The BSD functions are <b>thread</b> <b>safe</b> and must be used with a CMSIS-RTOS.</li>
</ul>
</dd></dl>
<h2><a class="anchor" id="autotoc_md75"></a>
Communication Flow</h2>
<p>The image below explains the basic communication flow using BSD sockets with TCP.</p>
<div class="image">
<img src="NW_Diagrams.png" alt=""/>
<div class="caption">
Flow Diagram for BSD Sockets Communication using TCP</div></div>
<p><a class="anchor" id="using_network_sockets_bsd_server"></a></p>
<h2><a class="anchor" id="autotoc_md76"></a>
BSD Server</h2>
<p>The BSD server creates a <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>, uses <a class="el" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a">bind</a> to attach that socket to a port, and configures it as a <a class="el" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa">listening</a> socket. This allows the server to receive incoming connection requests. Afterwards, <a class="el" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4">accept</a> is called, which will block the socket, until an incoming connection request is received. When <a class="el" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4">accept</a> returns, the <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure will have been filled out with the originating IP Address and port of the incoming connection. Then, <a class="el" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4">accept</a> creates a new socket, which is then used to <a class="el" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba">receive</a> data until the connection is <a class="el" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21">closed</a> by the other side.</p>
<p><b>Code Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, sd, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Bind to IPv4 any address</span></div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(1000);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa" title="Set a socket in a listening mode. [thread-safe].">listen</a> (sock, 1);</div>
<div class="line">    sd = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4" title="Accept connect request for a listening socket. [thread-safe].">accept</a> (sock, NULL, NULL);</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sd, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_SetOut (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sd);</div>
<div class="line">    osDelay (100);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="using_network_sockets_bsd_server_ds"></a></p>
<h2><a class="anchor" id="autotoc_md77"></a>
BSD Server Dual-Stack</h2>
<p>Dual-Stack sockets offer the ability to create a single IPv6 socket which can handle both IPv6 and IPv4 communication. For example, a TCP listening socket for IPv6 is created, put into dual-stack mode, and bound to port 1000. The dual-stack socket can accept connections from IPv6 TCP clients and IPv4 TCP clients that connect to port 1000.</p>
<p>The IPv4 address is encoded in the <b>IPv4-mapped</b> IPv6 address with the address prefix <b>0:0:0:0:0:FFFF</b>, last four bytes of the address are the IPv4 address. The IPv4 address in this format can be used in a dual-stack socket communication. If the IPv4 address is converted to a string address with the function <a class="el" href="group__using__network__sockets__bsd__func.html#ga0bd214382fd14e4428076d88ced3748b">inet_ntop</a>, the result is represented in a hybrid dotted decimal notation. For example, the address 192.168.0.100 is converted to a string: </p><div class="fragment"><div class="line">::FFFF:192.168.0.100</div>
</div><!-- fragment --><p><b>Code Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN6" title="IPv6 Socket Address structure.">SOCKADDR_IN6</a> addr;</div>
<div class="line">  int32_t sock, sd, res, on;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#aa03706b2738b9a58d4985dfbe99e1bac" title="Internet Address Family version 6.">AF_INET6</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Disable IPv6-only</span></div>
<div class="line">    on = 0;</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7" title="Manipulate options for the socket. [thread-safe].">setsockopt</a> (sock, <a class="code hl_define" href="rl__net_8h.html#a029fc3b9526146e54addf53ca297e629" title="IPv6 Level.">IPPROTO_IPV6</a>, <a class="code hl_define" href="rl__net_8h.html#a48fb8bf5da186346125c2750265b0c65" title="Restrict to IPv6 communications only (default on)">IPV6_V6ONLY</a>, (<span class="keywordtype">char</span> *)&amp;on, <span class="keyword">sizeof</span>(on));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Bind to IPv6 any address</span></div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#adeae4aa8a3e12d56e503cb48580f8b88" title="Socket domain.">sin6_family</a>   = <a class="code hl_define" href="rl__net_8h.html#aa03706b2738b9a58d4985dfbe99e1bac" title="Internet Address Family version 6.">AF_INET6</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#aa0afd7084eba59d952adef60322dbeeb" title="Port.">sin6_port</a>     = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(1000);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a610b1d4d8b1c716803c4823161738a9d" title="IP6 address.">sin6_addr</a>     = <a class="code hl_variable" href="rl__net_8h.html#a5585f1265505f1dd6b7bb56798faa8c0" title="BSD Internet Addresses IPv6.">in6addr_any</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a138ebc1c19f0abefdbdd39aadbdd00eb" title="IP6 flow information.">sin6_flowinfo</a> = 0;</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa" title="Set a socket in a listening mode. [thread-safe].">listen</a> (sock, 1);</div>
<div class="line">    sd = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4" title="Accept connect request for a listening socket. [thread-safe].">accept</a> (sock, NULL, NULL);</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sd, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_SetOut (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sd);</div>
<div class="line">    osDelay (100);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="using_network_sockets_bsd_client"></a></p>
<h2><a class="anchor" id="autotoc_md78"></a>
BSD Client</h2>
<p>The BSD Client creates a <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> calls <a class="el" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b">connect</a>, because TCP requires a negotiated connection. Afterwards, <a class="el" href="group__using__network__sockets__bsd__func.html#ga4cc5678cb81694afc224221063fda9cd">send</a> is called to send the data to the server. Note that <a class="el" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a">bind</a> is never called, because the stack will pick a random port and an appropriate IP address. To finish the communication, the client calls <a class="el" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21">closesocket</a>.</p>
<p><b>Code Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Client_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t leds;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a> = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>   = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(1000);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>   = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga57fbb43943b1a1226814c7acf881bf1c" title="Convert from text address to a network address. [thread-safe].">inet_addr</a> (<span class="stringliteral">&quot;192.168.0.100&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b" title="Connect a socket to a remote host. [thread-safe].">connect</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"> </div>
<div class="line">    leds = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs</span></div>
<div class="line">      LED_SetOut (leds);</div>
<div class="line">      <span class="keywordflow">if</span> (leds == 0x80) leds = 0x01;</div>
<div class="line">      <span class="keywordflow">else</span>              leds &lt;&lt;= 1;</div>
<div class="line">    </div>
<div class="line">      <span class="comment">// Send the data to LED Server.</span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4cc5678cb81694afc224221063fda9cd" title="Send data on already connected socket. [thread-safe].">send</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (300);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="ga34f0c4489df12e0ce4972a78ec3d62b4" name="ga34f0c4489df12e0ce4972a78ec3d62b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga34f0c4489df12e0ce4972a78ec3d62b4">&#9670;&#160;</a></span>accept()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t accept </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept connect request for a listening socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">addr</td><td>structure that will receive IP address and port number.<ul>
<li>NULL for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>New socket descriptor (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Socket not in listen mode.</li>
<li>BSD_ENOTSUP = Operation not supported for this socket type.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ECONNRESET = Connection reset by the peer.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>accept</b> accepts a connection request queued for a listening socket. If a connection request is pending, <b>accept</b> removes the request from the queue, and a new socket is created for the connection. The original listening socket remains open and continues to queue new connection requests. The socket <em>sock</em> must be a <b>SOCK_STREAM</b> type socket.</p>
<p>In blocking mode, which is enabled by default, this function waits for a connection request. In non blocking mode, you must call the <b>accept</b> function again if the error code <code>BSD_EWOULDBLOCK</code> is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure that will receive the connection node IP address and port number.</p>
<p>The argument <em>addrlen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>addr</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>) </p>

</div>
</div>
<a id="ga371b442b92e67a6046b168521d4a1b4a" name="ga371b442b92e67a6046b168521d4a1b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga371b442b92e67a6046b168521d4a1b4a">&#9670;&#160;</a></span>bind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t bind </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign a local address and port to a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing local IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter or already bound.</li>
<li>BSD_EADDRINUSE = Address or port already in use.</li>
<li>BSD_EISCONN = Socket already connected.</li>
</ul>
</dd></dl>
<p>The function <b>bind</b> assigns a name to an unnamed socket. The name represents the local address and port of the communication endpoint.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure containing the local address and port of the socket. If the port is specified as <span class="XML-Token">0</span>, the Network Core assigns a unique port from the dynamic client port range (ephemeral ports).</p>
<p>The argument <em>addrlen</em> specifies the length of the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
<li>You can retrieve the assigned dynamic port with <a class="el" href="group__using__network__sockets__bsd__func.html#ga8cdaa88cc2ccc643495063e2dbe5cc5a">getsockname</a> function.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>) </p>

</div>
</div>
<a id="ga50c4d62065c117f425ae2734e7979f21" name="ga50c4d62065c117f425ae2734e7979f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50c4d62065c117f425ae2734e7979f21">&#9670;&#160;</a></span>closesocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t closesocket </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close socket and release socket descriptor. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>closesocket</b> closes an existing socket and releases the socket descriptor. Further references to <code>sock</code> fail with <code>BSD_EINVAL</code> error code.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>In blocking mode, which is enabled by default, this function will wait until a socket is closed. In non blocking mode, you must call the <b>closesocket</b> function again if the error code <code>BSD_EWOULDBLOCK</code> is returned.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>) </p>

</div>
</div>
<a id="ga9feed17ea4fc7449b8159eabc131ed5b" name="ga9feed17ea4fc7449b8159eabc131ed5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9feed17ea4fc7449b8159eabc131ed5b">&#9670;&#160;</a></span>connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t connect </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Connect a socket to a remote host. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing remote IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addrlen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter or socket in wrong state.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_EALREADY = Connection already in progress.</li>
<li>BSD_EINPROGRESS = Operation in progress.</li>
<li>BSD_EISCONN = Socket is connected.</li>
<li>BSD_ECONNREFUSED = Connection rejected by the peer.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>connect</b> assigns the address of the peer communication endpoint. The function behaves differently according to the type of socket:</p>
<ul>
<li><p class="startli"><b>SOCK_STREAM:</b> A connection is established between the endpoints.</p>
<p class="startli">In blocking mode, which is enabled by default, this function waits for a connection to be established.</p>
<p class="startli">In non blocking mode, the function returns the error code <code>BSD_EINPROGRESS</code> and the connection is established asynchronously. Subsequent calls to <b>connect</b> for the same socket, before the connection is established, return the error code <code>BSD_EALREADY</code>. When the connection is established, the call to <b>connect</b> returns the error code <code>BSD_EISCONN</code>.</p>
</li>
<li><p class="startli"><b>SOCK_DGRAM:</b> An address filter is established between the endpoints.</p>
<p class="startli">The address filter is changed with another <b>connect</b> function call. If the socket is not yet bound, the system implicitly binds to a random dynamic port.</p>
</li>
</ul>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>addr</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure that contains the endpoint node IP address and port number.</p>
<p>The argument <em>addrlen</em> specifies the length of <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Client_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res, lshift;</div>
<div class="line">  int32_t type = (int32_t)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t p2val;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, type, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>      = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>    = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1 = IP1;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2 = IP2;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3 = IP3;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4 = IP4;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b" title="Connect a socket to a remote host. [thread-safe].">connect</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"> </div>
<div class="line">    lshift = 1;</div>
<div class="line">    p2val  = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs </span></div>
<div class="line">      LED_SetOut (p2val);</div>
<div class="line">      p2val = lshift ? (p2val &lt;&lt; 1) : (p2val &gt;&gt; 1);</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x80) lshift = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x01) lshift = 1;</div>
<div class="line">    </div>
<div class="line">      <span class="comment">// Send the data to LED Server</span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4cc5678cb81694afc224221063fda9cd" title="Send data on already connected socket. [thread-safe].">send</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (100 * SPEED);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga960a2fca6713ffbd8889a41f15e5c0ac" name="ga960a2fca6713ffbd8889a41f15e5c0ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga960a2fca6713ffbd8889a41f15e5c0ac">&#9670;&#160;</a></span>gethostbyname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__bsd__structs.html#structHOSTENT">HOSTENT</a> * gethostbyname </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve host IP address from host name. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>host name. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>pointer to where to return error code (NULL for none):<ul>
<li>0 = Operation successful.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Resolver locked by another thread.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_EHOSTNOTFOUND = Host not found.</li>
<li>BSD_ERROR = Unspecified error. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li><a class="el" href="group__bsd__structs.html#structHOSTENT">HOSTENT</a> result structure.</li>
<li>NULL in case of error.</li>
</ul>
</dd></dl>
<p>The function <b>gethostbyname</b> retrieves host information corresponding to a host name from a host database.</p>
<p>The argument <em>name</em> is a pointer to the <span class="XML-Token">null</span>-terminated name of the host to resolve.</p>
<p>The argument <em>err</em> is a pointer to the return error code.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>To use this function, you must enable the <a class="el" href="group__netDNSc__Func.html">DNS client</a> in the selection of RTE Components.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *hosts[] = {</div>
<div class="line">  <span class="stringliteral">&quot;www.google.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.keil.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.microsoft.com&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;www.yahoo.com&quot;</span>,</div>
<div class="line">  NULL</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Resolver_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structHOSTENT" title="BSD Host Entry structure.">HOSTENT</a> *host;</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structIN__ADDR" title="Generic IPv4 Address structure.">IN_ADDR</a> *addr;</div>
<div class="line">  int32_t i, j, err;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (i = 0; ; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (hosts[i] == NULL) i = 0;</div>
<div class="line">    printf (<span class="stringliteral">&quot;Host: %s\n&quot;</span>,hosts[i]);</div>
<div class="line"> </div>
<div class="line">    host = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga960a2fca6713ffbd8889a41f15e5c0ac" title="Retrieve host IP address from host name. [thread-safe].">gethostbyname</a> (hosts[i], &amp;err);</div>
<div class="line">    <span class="keywordflow">if</span> (host == NULL) {</div>
<div class="line">      <span class="keywordflow">if</span> (err == <a class="code hl_define" href="group__bsd__errors.html#ga0c4a235f1d86e6243367959ab073d41f" title="Host not found.">BSD_EHOSTNOTFOUND</a>) {</div>
<div class="line">        printf (<span class="stringliteral">&quot;Hostname does not exist\n&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (host-&gt;<a class="code hl_variable" href="group__bsd__structs.html#aa94ed2e671740aa0ccd82e8d18abccae" title="Address Type: AF_INET, AF_NETBIOS.">h_addrtype</a> == <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (j = 0; host-&gt;<a class="code hl_variable" href="group__bsd__structs.html#a058204dad180c9850b3ffaf6b32f5b4c" title="Pointer to an array of IPv4 addresses.">h_addr_list</a>[j]; j++) {</div>
<div class="line">        addr = (<a class="code hl_struct" href="group__bsd__structs.html#structIN__ADDR" title="Generic IPv4 Address structure.">IN_ADDR</a> *)host-&gt;<a class="code hl_variable" href="group__bsd__structs.html#a058204dad180c9850b3ffaf6b32f5b4c" title="Pointer to an array of IPv4 addresses.">h_addr_list</a>[j];</div>
<div class="line">        printf(<span class="stringliteral">&quot;IP Address: %s\n&quot;</span>, <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(addr-&gt;s_addr));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    osDelay (300);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga4197286e9ca6483174462fe0cbdc5c67" name="ga4197286e9ca6483174462fe0cbdc5c67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4197286e9ca6483174462fe0cbdc5c67">&#9670;&#160;</a></span>getpeername()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t getpeername </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>namelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve IP address and port number of the endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">name</td><td>structure that will receive IP address and port number. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">namelen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
</ul>
</dd></dl>
<p>The function <b>getpeername</b> retrieves the address of the peer to which a socket is connected.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>name</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure. If <em>name</em> is not <span class="XML-Token">NULL</span>, the remote end IP address and port number will be filled in.</p>
<p>The argument <em>namelen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>name</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, sd, res, addrlen;</div>
<div class="line">  int32_t type = (int32_t)arg;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, type, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (type == <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>) {</div>
<div class="line">      <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa" title="Set a socket in a listening mode. [thread-safe].">listen</a> (sock, 1);</div>
<div class="line">      sd = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4" title="Accept connect request for a listening socket. [thread-safe].">accept</a> (sock, NULL, NULL);</div>
<div class="line">      <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">      sock = sd;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">      addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">      <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4197286e9ca6483174462fe0cbdc5c67" title="Retrieve IP address and port number of the endpoint node. [thread-safe].">getpeername</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, &amp;addrlen);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP:   %s\n&quot;</span>, <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(addr.sin_addr));</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>, <a class="code hl_define" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.sin_port));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga8cdaa88cc2ccc643495063e2dbe5cc5a" name="ga8cdaa88cc2ccc643495063e2dbe5cc5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8cdaa88cc2ccc643495063e2dbe5cc5a">&#9670;&#160;</a></span>getsockname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t getsockname </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>namelen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve local IP address and port number. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">name</td><td>structure that will receive IP address and port number. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">namelen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter or socket not bound.</li>
</ul>
</dd></dl>
<p>The function <b>getsockname</b> retrieves the local address for a socket.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>name</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure. If <em>name</em> is not <span class="XML-Token">NULL</span>, the local IP address and port number will be filled in.</p>
<p>The argument <em>namelen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>name</em>. On return it contains the actual length of the address returned in bytes.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res, addrlen;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, <a class="code hl_define" href="rl__net_8h.html#ab332d40b15142f33a88d4fcb1d6a5920" title="UDP Protocol.">IPPROTO_UDP</a>);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(1001);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line"> </div>
<div class="line">    addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga8cdaa88cc2ccc643495063e2dbe5cc5a" title="Retrieve local IP address and port number. [thread-safe].">getsockname</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, &amp;addrlen);</div>
<div class="line">    printf (<span class="stringliteral">&quot;Local IP:   %s\n&quot;</span>, <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(addr.sin_addr));</div>
<div class="line">    printf (<span class="stringliteral">&quot;Local port: %d\n&quot;</span>, <a class="code hl_define" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.sin_port));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga5bcdb9de12a6f30c3b404b9b54d74c1f" name="ga5bcdb9de12a6f30c3b404b9b54d74c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bcdb9de12a6f30c3b404b9b54d74c1f">&#9670;&#160;</a></span>getsockopt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t getsockopt </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>optlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve options for the socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level at which the option is defined:<ul>
<li>SOL_SOCKET = Socket level.</li>
<li>IPPROTO_IP = IPv4 protocol level.</li>
<li>IPPROTO_IPV6 = IPv6 protocol level. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optname</td><td>socket option for which the value is to be retrieved:<ul>
<li>SO_TYPE = Type of a socket.</li>
<li>SO_KEEPALIVE = Keep Alive.</li>
<li>SO_RCVTIMEO = Timeout for blocking receive (in ms).</li>
<li>SO_SNDTIMEO = Timeout for blocking send (in ms).</li>
<li>SO_BINDTODEVICE = Bound network interface (class and number).</li>
<li>IP_RECVDSTADDR = Receive Destination IP Address.</li>
<li>IP_TOS = Type of Service (TOS).</li>
<li>IP_TTL = Time to Live (TTL).</li>
<li>IPV6_TCLASS = Traffic Class.</li>
<li>IPV6_MULTICAST_HOPS = Multi-cast Hop Limit.</li>
<li>IPV6_RECVDSTADDR = Receive Destination IPv6 Address.</li>
<li>IPV6_V6ONLY = Restrict to IPv6 communications only. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">optval</td><td>pointer to the buffer that will receive the option value. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">optlen</td><td>input length of buffer, return length of the data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ENOTSUP = Option not supported for this socket type.</li>
</ul>
</dd></dl>
<p>The function <b>getsockopt</b> retrieves options for a socket. Options may exist at multiple protocol levels.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>level</em> describes the level at which the option is defined (for example SOL_SOCKET).</p>
<p>The argument <em>optname</em> is the socket option for which the value is to be retrieved and must be defined within the specified <em>level</em>.</p>
<p>The argument <em>optval</em> points to the buffer that will receive the value of the <em>optname</em>.</p>
<p>The argument <em>optlen</em> contains the length of the buffer at the input and returns the length of the option information on the output.</p>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Retrieve keep-alive mode for stream socket</span></div>
<div class="line"><span class="keywordtype">char</span> optval;</div>
<div class="line">int32_t optlen = <span class="keyword">sizeof</span>(optval);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga5bcdb9de12a6f30c3b404b9b54d74c1f" title="Retrieve options for the socket. [thread-safe].">getsockopt</a> (sock, <a class="code hl_define" href="rl__net_8h.html#a92d045f6ee2f343d6b28830a9fec082e" title="BSD Socket level.">SOL_SOCKET</a>, <a class="code hl_define" href="rl__net_8h.html#a0691781c519eed3f9a634f8eb55cd258" title="BSD Socket options.">SO_KEEPALIVE</a>, &amp;optval, &amp;optlen);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (optval != 0) {</div>
<div class="line">  printf (<span class="stringliteral">&quot;Keep-alive mode is active.&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga57fbb43943b1a1226814c7acf881bf1c" name="ga57fbb43943b1a1226814c7acf881bf1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga57fbb43943b1a1226814c7acf881bf1c">&#9670;&#160;</a></span>inet_addr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a> inet_addr </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from text address to a network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cp</td><td>text address in standard dotted-decimal notation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Internet address on success.</li>
<li>INADDR_NONE = on error.</li>
</ul>
</dd></dl>
<p>The function <b>inet_addr</b> converts the specified string to an integer value suitable for use as an Internet address.</p>
<p>The argument <em>cp</em> is a pointer to the <span class="XML-Token">null</span>-terminated string in the standard IPv4 dotted decimal notation.</p>
<p>The function returns the converted Internet address on success, or <a class="el" href="rl__net_8h.html#a3d2472d6cf31b73eeb829110dd0fffea">INADDR_NONE</a> if failed.</p>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gada37f8d9ecd2195bcad7717a295d2ad2">inet_aton</a>) </p>

</div>
</div>
<a id="gada37f8d9ecd2195bcad7717a295d2ad2" name="gada37f8d9ecd2195bcad7717a295d2ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada37f8d9ecd2195bcad7717a295d2ad2">&#9670;&#160;</a></span>inet_aton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t inet_aton </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from text address to a network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cp</td><td>text address in standard dotted-decimal notation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">addr</td><td>buffer where the converted IPv4 address is to be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>1 = Conversion successful.</li>
<li>0 = Conversion failed.</li>
</ul>
</dd></dl>
<p>The function <b>inet_aton</b> converts the specified string to a network address, and stores the address in the structure provided.</p>
<p>The argument <em>cp</em> is a pointer to the <span class="XML-Token">null</span>-terminated string in the standard IPv4 dotted decimal notation.</p>
<p>The argument <em>addr</em> is a pointer to the buffer, where the converted address is to be stored.</p>
<p>The function returns <span class="XML-Token">1</span> if the address is successfully converted, or <span class="XML-Token">0</span> if the conversion failed.</p>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>sockaddr_in sa;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *some_addr;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gada37f8d9ecd2195bcad7717a295d2ad2" title="Convert from text address to a network address. [thread-safe].">inet_aton</a>(<span class="stringliteral">&quot;10.0.0.1&quot;</span>, &amp;sa.sin_addr); <span class="comment">// store IP in sa</span></div>
<div class="line"> </div>
<div class="line">some_addr = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(sa.sin_addr);  <span class="comment">// return the IP</span></div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, some_addr);           <span class="comment">// prints &quot;10.0.0.1&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// This call is the same as the inet_aton() call, above:</span></div>
<div class="line">sa.sin_addr = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga57fbb43943b1a1226814c7acf881bf1c" title="Convert from text address to a network address. [thread-safe].">inet_addr</a>(<span class="stringliteral">&quot;10.0.0.1&quot;</span>);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga9123668788ba0c48c7ee439f325e728a" name="ga9123668788ba0c48c7ee439f325e728a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9123668788ba0c48c7ee439f325e728a">&#9670;&#160;</a></span>inet_ntoa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet_ntoa </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structIN__ADDR">IN_ADDR</a>&#160;</td>
          <td class="paramname"><em>in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from network address to a text string. [<a class="el" href="group__function__categories.html#not_thread-safe">not_thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Internet IPv4 host address to convert. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the formatted string.</dd></dl>
<p>The function <b>inet_ntoa</b> converts the specified Internet host address to a string in the standard dotted decimal notation.</p>
<p>The argument <em>in</em> is the Internet host address to be converted.</p>
<p>The function returns a pointer to the <span class="XML-Token">null</span>-terminated string in the standard IPv4 dotted decimal notation.</p>
<dl class="section note"><dt>Note</dt><dd>The function uses a static buffer for the converted address and is therefore not thread safe.</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gada37f8d9ecd2195bcad7717a295d2ad2">inet_aton</a>) </p>

</div>
</div>
<a id="ga0bd214382fd14e4428076d88ced3748b" name="ga0bd214382fd14e4428076d88ced3748b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0bd214382fd14e4428076d88ced3748b">&#9670;&#160;</a></span>inet_ntop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * inet_ntop </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from binary network address to a text string. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">af</td><td>address family:<ul>
<li>AF_INET = Internet Address Family (IPv4).</li>
<li>AF_INET6 = Internet Address Family version 6 (IPv6). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>binary address in network byte order to be converted. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dst</td><td>buffer where the converted text address is to be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>size of the buffer, at least:<ul>
<li>INET_ADDRSTRLEN for AF_INET.</li>
<li>INET6_ADDRSTRLEN for AF_INET6. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the formatted string.<ul>
<li>NULL in case of error.</li>
</ul>
</dd></dl>
<p>The function <b>inet_ntop</b> converts an address from network format in network byte order to presentation format.</p>
<p>The argument <em>af</em> specifies the address family. Currently, only <a class="el" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826">AF_INET</a> and <a class="el" href="rl__net_8h.html#aa03706b2738b9a58d4985dfbe99e1bac">AF_INET6</a> are supported.</p>
<p>The argument <em>src</em> is a pointer to the network address. The format of the address is interpreted according to argument <em>af</em>.</p>
<p>The argument <em>dst</em> is a pointer to the buffer where the converted address is to be stored.</p>
<p>The argument <em>size</em> specifies the size of the buffer pointed to by <em>dst</em>. The size must be at least <a class="el" href="rl__net_8h.html#a93b37007689284fd9c4bde1a8f4b9199">INET_ADDRSTRLEN</a> bytes for an IPv4 address and <a class="el" href="rl__net_8h.html#af776b22a727aae7c9f4d869d50df47e8">INET6_ADDRSTRLEN</a> bytes for an IPv6 address.</p>
<p>The function returns a pointer to <em>dst</em> if the address is successfully converted, or <span class="XML-Token">NULL</span> if the conversion failed.</p>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gaadac07d29a87adfc6435582c989cdbc2">inet_pton</a>) </p>

</div>
</div>
<a id="gaadac07d29a87adfc6435582c989cdbc2" name="gaadac07d29a87adfc6435582c989cdbc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaadac07d29a87adfc6435582c989cdbc2">&#9670;&#160;</a></span>inet_pton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t inet_pton </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>af</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert from text address to a binary network address. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">af</td><td>address family:<ul>
<li>AF_INET = Internet Address Family (IPv4).</li>
<li>AF_INET6 = Internet Address Family version 6 (IPv6). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>text address to be converted. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dst</td><td>buffer where the converted address is to be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>1 = Conversion successful.</li>
<li>0 = Conversion failed.</li>
</ul>
</dd></dl>
<p>The function <b>inet_pton</b> converts an address from presentation format to network format in network byte order.</p>
<p>The argument <em>af</em> specifies the address family. Currently, only <a class="el" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826">AF_INET</a> and <a class="el" href="rl__net_8h.html#aa03706b2738b9a58d4985dfbe99e1bac">AF_INET6</a> are supported.</p>
<p>The argument <em>src</em> is a pointer to the <span class="XML-Token">null</span>-terminated presentation format address. The format of the address is interpreted according to argument <em>af</em>.</p>
<p>The argument <em>dst</em> is a pointer to the buffer where the converted address is to be stored.</p>
<p>The function returns <span class="XML-Token">1</span> if the address is successfully converted, or <span class="XML-Token">0</span> if the conversion failed.</p>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>sockaddr_in sa;</div>
<div class="line"><span class="keywordtype">char</span> str[<a class="code hl_define" href="rl__net_8h.html#a93b37007689284fd9c4bde1a8f4b9199" title="BSD address string length.">INET_ADDRSTRLEN</a>];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Store this IP address in sa</span></div>
<div class="line"><a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaadac07d29a87adfc6435582c989cdbc2" title="Convert from text address to a binary network address. [thread-safe].">inet_pton</a>(<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <span class="stringliteral">&quot;192.168.0.100&quot;</span>, &amp;(sa.sin_addr));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now get it back and print it</span></div>
<div class="line"><a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga0bd214382fd14e4428076d88ced3748b" title="Convert from binary network address to a text string. [thread-safe].">inet_ntop</a>(<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, &amp;(sa.sin_addr), str, <a class="code hl_define" href="rl__net_8h.html#a93b37007689284fd9c4bde1a8f4b9199" title="BSD address string length.">INET_ADDRSTRLEN</a>);</div>
<div class="line"> </div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, str);     <span class="comment">// prints &quot;192.168.0.100&quot;</span></div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga8f69a56936f963ac8f9b9c74ae7e95bb" name="ga8f69a56936f963ac8f9b9c74ae7e95bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8f69a56936f963ac8f9b9c74ae7e95bb">&#9670;&#160;</a></span>ioctlsocket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t ioctlsocket </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>argp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Control IO mode of a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cmd</td><td>command to perform:<ul>
<li>FIONBIO = enable non-blocking mode. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argp</td><td>command's parameter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ENOTSUP = Option not supported for this socket type.</li>
</ul>
</dd></dl>
<p>The function <b>ioctlsocket</b> controls the I/O mode of a socket. It can be used on any socket in any state to set or retrieve some operating parameters of the socket.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>cmd</em> specifies a command to perform on a socket. The following commands are supported: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">FIONBIO</span>   </td><td class="markdownTableBodyNone">Sets the blocking or non-blocking socket I/O mode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">FIO_DELAY_ACK</span>   </td><td class="markdownTableBodyNone">Sets the delay-ack or normal mode for the stream socket    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">FIO_KEEP_ALIVE</span>   </td><td class="markdownTableBodyNone">Sets the keep-alive or timeout mode for the stream socket    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">FIO_FLOW_CTRL</span>   </td><td class="markdownTableBodyNone">Sets the receive flow-control or normal mode for the stream socket   </td></tr>
</table>
<p>The argument <em>argp</em> specifies a pointer to the command's parameter. <br  />
 For the command <b>FIONBIO</b> the argument values are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">*argp value   </th><th class="markdownTableHeadNone">I/O mode    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">0</span>   </td><td class="markdownTableBodyNone">Blocking mode    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">nonzero</span>   </td><td class="markdownTableBodyNone">Non-blocking mode   </td></tr>
</table>
<p>For the command <b>FIO_DELAY_ACK</b> the argument values are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">*argp value   </th><th class="markdownTableHeadNone">Socket mode   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">0</span>   </td><td class="markdownTableBodyNone">Normal mode   </td><td class="markdownTableBodyNone">Waits for an ACK after each sending packet    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">nonzero</span>   </td><td class="markdownTableBodyNone">Delay-ack mode   </td><td class="markdownTableBodyNone">Eliminates the delayed acknowledge impact and improves the performance for applications sending large amount of data   </td></tr>
</table>
<p>For the command <b>FIO_KEEP_ALIVE</b> the argument values are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">*argp value   </th><th class="markdownTableHeadNone">Socket mode   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">0</span>   </td><td class="markdownTableBodyNone">Timeout mode   </td><td class="markdownTableBodyNone">After a timeout a stream socket is disconnected    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">nonzero</span>   </td><td class="markdownTableBodyNone">Keep-alive mode   </td><td class="markdownTableBodyNone">Stream socket sends keep alive segments on timeout to keep a connection alive   </td></tr>
</table>
<p>For the command <b>FIO_FLOW_CTRL</b> the argument values are: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">*argp value   </th><th class="markdownTableHeadNone">Socket mode   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">0</span>   </td><td class="markdownTableBodyNone">Normal mode   </td><td class="markdownTableBodyNone">Stream socket dumps excess data, if the receiving buffer is full    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">nonzero</span>   </td><td class="markdownTableBodyNone">Flow-control mode   </td><td class="markdownTableBodyNone">Stream socket controls the window size and stops the transmitter, if the receiving buffer is full   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>Negative return numbers represent error codes.</li>
<li>The <em>blocking</em> mode is enabled by default.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  int32_t sock, res;</div>
<div class="line">  <span class="keywordtype">long</span> sck_mode;</div>
<div class="line"> </div>
<div class="line">  sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, <a class="code hl_define" href="rl__net_8h.html#a94f83c72c1e5e6ef453e47cf59885fb5" title="BSD Socket Protocol.">IPPROTO_TCP</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// 0= blocking, 1= non-blocking </span></div>
<div class="line">  sck_mode = 1;</div>
<div class="line">  res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga8f69a56936f963ac8f9b9c74ae7e95bb" title="Control IO mode of a socket. [thread-safe].">ioctlsocket</a> (sock, <a class="code hl_define" href="rl__net_8h.html#af48a6e38eb0ae226621514b44b9844eb" title="BSD Socket ioctl commands.">FIONBIO</a>, &amp;sck_mode);</div>
<div class="line">  <span class="keywordflow">if</span> (res == 0) {</div>
<div class="line">    printf (<span class="stringliteral">&quot;Nonblocking mode enabled.\n&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    printf (<span class="stringliteral">&quot;ioctlsocket() error\n!&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  ..</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga4dde9362ae7fd2b2a60eeba388874afa" name="ga4dde9362ae7fd2b2a60eeba388874afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4dde9362ae7fd2b2a60eeba388874afa">&#9670;&#160;</a></span>listen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t listen </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>backlog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set a socket in a listening mode. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">backlog</td><td>number of connection requests that can be accepted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter, socket not bound or already listening.</li>
<li>BSD_ENOTSUP = Operation not supported for this socket type.</li>
<li>BSD_ERROR = Failed to create socket backlog.</li>
</ul>
</dd></dl>
<p>The function <b>listen</b> sets the specified socket to listening mode. Before calling the <b>listen</b> function, the <a class="el" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a">bind</a> function must be called.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>backlog</em> specifies a maximum number of connection requests that can be accepted.</p>
<p>This is different from the standard BSD listening function. The reason for this is that BSD sockets in the network component are just a layer on top of native <a class="el" href="group__netTCP__Func.html">TCP Socket</a>. TCP sockets, however, are static, meaning that they are defined at compile time and are not dynamically allocated objects.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>) </p>

</div>
</div>
<a id="gaf6d5bc55c3bcbed83a0e03eae48010ba" name="gaf6d5bc55c3bcbed83a0e03eae48010ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6d5bc55c3bcbed83a0e03eae48010ba">&#9670;&#160;</a></span>recv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t recv </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data on already connected socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to application data buffer to store the data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>size of application data buffer (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait for data.</li>
<li>MSG_PEEK = peek at incoming data.</li>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes received (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
<li>BSD_ECONNRESET = Connection reset by the peer.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>recv</b> receives incoming data that has been queued for the socket. This function can be used with both <b>SOCK_STREAM</b> and <b>SOCK_DGRAM</b> type sockets. It reads as much information as currently available up to the size of the buffer specified. The excess data is treated differently according to the type of socket:</p>
<ul>
<li><p class="startli"><b>SOCK_STREAM:</b> The excess data is buffered internally.</p>
<p class="startli">The application can retrieve all data by multiple calls of <b>recv</b> function.</p>
</li>
<li><p class="startli"><b>SOCK_DGRAM:</b> The excess message data is silently discarded.</p>
<p class="startli">The data is extracted from the first enqueued datagram. If the datagram or message is larger than the buffer specified, the buffer is filled with the first part of the datagram, the excess data of this datagram is silently discarded. All subsequent messages that are enqueued, are retained. The message size is currently limited to 2000 characters. You need to enable <b>IP</b> <b>Fragmentation</b> in the interface configuration so that you can receive 2000 byte datagram messages.</p>
</li>
</ul>
<p>In blocking mode, which is enabled by default, this function waits for received data. In non blocking mode, you must call the <b>recv</b> function again if the error code <code>BSD_EWOULDBLOCK</code> is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer for storing the data to.</p>
<p>The argument <em>len</em> specifies the size of the application data buffer.</p>
<p>The argument <em>flags</em> specifies the message flags:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_DONTWAIT</span>   </td><td class="markdownTableBodyNone">The function returns with error code <code>BSD_EWOULDBLOCK</code> or <b>number of bytes</b> received instead of blocking the socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_PEEK</span>   </td><td class="markdownTableBodyNone">The function peeks at incoming data. The data is copied into the buffer, but is not removed from the input queue.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>) </p>

</div>
</div>
<a id="gaafe47bf7123d59a831e0f337bd283872" name="gaafe47bf7123d59a831e0f337bd283872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaafe47bf7123d59a831e0f337bd283872">&#9670;&#160;</a></span>recvfrom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t recvfrom </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *&#160;</td>
          <td class="paramname"><em>fromlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive data from endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>pointer to application data buffer to store the data to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>size of application data buffer (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait for data.</li>
<li>MSG_PEEK = peek at incoming data.</li>
<li>0 = for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">from</td><td>structure that will receive IP address and port number.<ul>
<li>NULL for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">fromlen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes received (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
<li>BSD_ECONNRESET = Connection reset by the peer.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>recvfrom</b> is used to receive data that has been queued for a socket. It is normally used to receive messages on <b>SOCK_DGRAM</b> socket type, but can also be used to receive a reliable, ordered stream of data on a connected <b>SOCK_STREAM</b> socket type. It reads as much information as currently available up to the size of the buffer specified. The excess data is treated differently according to the type of socket:</p>
<ul>
<li><p class="startli"><b>SOCK_STREAM:</b> The excess data is buffered internally.</p>
<p class="startli">The application can retrieve all data by multiple calls of <b>recvfrom</b> function.</p>
</li>
<li><p class="startli"><b>SOCK_DGRAM:</b> The excess message data is silently discarded.</p>
<p class="startli">The data is extracted from the first enqueued datagram. If the datagram or message is larger than the buffer specified, the buffer is filled with the first part of the datagram, the excess data of this datagram is silently discarded. All subsequent messages that are enqueued, are retained. The message size is currently limited to 2000 characters. You need to enable <b>IP</b> <b>Fragmentation</b> in the interface configuration so that you can receive 2000 byte datagram messages.</p>
</li>
</ul>
<p>In blocking mode, which is enabled by default, this function waits for received data. In non blocking mode, you must call the <b>recvfrom</b> function again if the error code <code>BSD_EWOULDBLOCK</code> is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer for storing the data to.</p>
<p>The argument <em>len</em> specifies the size of the application data buffer.</p>
<p>The argument <em>flags</em> specifies the message flags:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_DONTWAIT</span>   </td><td class="markdownTableBodyNone">The function returns with error code <code>BSD_EWOULDBLOCK</code> or <b>number of bytes</b> received instead of blocking the socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_PEEK</span>   </td><td class="markdownTableBodyNone">The function peeks at incoming data. The data is copied into the buffer, but is not removed from the input queue.   </td></tr>
</table>
<p>The argument <em>from</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure. If <em>from</em> is not <span class="XML-Token">NULL</span>, the source IP address and port number of the datagram will be filled in.</p>
<p>The argument <em>fromlen</em> is a pointer to the address length. It should initially contain the amount of space pointed to by <em>from</em>. On return it contains the actual length of the address returned in bytes.</p>
<p>If the socket type is <b>SOCK_STREAM</b>, arguments <em>from</em> and <em>fromlen</em> are ignored.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
<li>The number of bytes actually read can be less than <em>len</em>.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res, addrlen;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      addrlen = <span class="keyword">sizeof</span> (addr);</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaafe47bf7123d59a831e0f337bd283872" title="Receive data from endpoint node. [thread-safe].">recvfrom</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, &amp;addrlen);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP:   %s\n&quot;</span>, <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(addr.sin_addr));</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>, <a class="code hl_define" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.sin_port));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga931d8f601c812a4497fc9e00f7e11936" name="ga931d8f601c812a4497fc9e00f7e11936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga931d8f601c812a4497fc9e00f7e11936">&#9670;&#160;</a></span>recvmsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t recvmsg </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive a message from a socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">msg</td><td>pointer to <a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> structure containing:<ul>
<li>pointer to buffer to store the source address to (NULL for none).</li>
<li>array of application buffer(s) for the incomming message.</li>
<li>pointer to buffer for the ancillary data (NULL for none). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait for data.</li>
<li>MSG_PEEK = peek at incoming data.</li>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes received (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTSUP = Operation not supported.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>recvmsg</b> is used to receive a message from a <b>SOCK_STREAM</b> or <b>SOCK_DGRAM</b> socket. It is normally used with <b>SOCK_DGRAM</b> sockets because it permits the application to retrieve the source address of received data.</p>
<p>In blocking mode, which is enabled by default, this function waits for received data. In non blocking mode, you must call the <b>recvmsg</b> function again if the error code <code>BSD_EWOULDBLOCK</code> is returned.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>msg</em> is a pointer to the <b>msghdr</b> structure, containing both the buffer to store the source address and the buffers for the incoming message.</p>
<ul>
<li>The <em>msg_name</em> member is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure. If <em>msg_name</em> is not <span class="XML-Token">NULL</span>, the source IP address and port number of the datagram will be filled in.</li>
<li>The <em>msg_namelen</em> member is the address length. It should initially contain the amount of space pointed to by <em>msg_name</em>. On return it contains the actual length of the address returned in bytes.</li>
<li>The <em>msg_iov</em> member is a pointer to scatter/gatther array of type <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em>. This array can specify one or more buffers, where the received data shall be stored.</li>
<li>The <em>msg_iovlen</em> member contains the number of <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em> buffers, that are available in the <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em> array.</li>
<li>The <em>msg_control</em> member is a pointer to a buffer, that will receive ancillary data.</li>
<li>The <em>msg_controllen</em> member is the buffer length. It should initially contain the amount of space pointed to by <em>msg_control</em>. On return it contains the actual length of the control data returned in bytes. The control data can be processed with the following macros:</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a326c46eb0fceb09b6ebb075804fd1e0c" title="BSD access ancillary data macros (RFC 2292).">CMSG_FIRSTHDR(mhdr)</a>   </td><td class="markdownTableBodyNone">Returns a pointer to the first <a class="el" href="group__bsd__structs.html#structCMSGHDR" title="BSD cmsg header structure.">CMSGHDR</a> structure in the <em>mhdr</em>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a4f70853d9633fb80428189cd7bb292d0">CMSG_NXTHDR(mhdr,cmsg)</a>   </td><td class="markdownTableBodyNone">Returns a pointer to the <a class="el" href="group__bsd__structs.html#structCMSGHDR" title="BSD cmsg header structure.">CMSGHDR</a> structure describing the next ancillary data object.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a5ab6d56e410ac0904107e84aeb1484cc">CMSG_DATA(cmsg)</a>   </td><td class="markdownTableBodyNone">Returns a pointer to the data of ancillary data object.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a907a77978127b9622f23f2778b0324a0">CMSG_ALIGN(len)</a>   </td><td class="markdownTableBodyNone">Rounds the argument up to the next even multiple of 4 bytes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a1cf31f7d0320e1fa024ebced6d54c8b9">CMSG_LEN(len)</a>   </td><td class="markdownTableBodyNone">Gives the length of an ancillary data object without padding.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a6a6d1e8e926f5b43e45353c7e8c3c7fa">CMSG_SPACE(len)</a>   </td><td class="markdownTableBodyNone">Gives the length of an ancillary data object including the padding needed.   </td></tr>
</table>
<ul>
<li>The <em>msg_flags</em> member is ignored on input, but may contain meaningful values on output:</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_TRUNC</span>   </td><td class="markdownTableBodyNone">Normal data was truncated, excess bytes are discarded in case of <b>SOCK_DGRAM</b> sockets.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_CTRUNC</span>   </td><td class="markdownTableBodyNone">Control data was truncated, ancillary data buffer is too small.   </td></tr>
</table>
<p>The argument <em>flags</em> specifies the message flags:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_DONTWAIT</span>   </td><td class="markdownTableBodyNone">The function returns with error code <code>BSD_EWOULDBLOCK</code> or <b>number of bytes</b> received instead of blocking the socket.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_PEEK</span>   </td><td class="markdownTableBodyNone">The function peeks at incoming data. The data is copied into the buffer, but is not removed from the input queue.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structIN__ADDR" title="Generic IPv4 Address structure.">IN_ADDR</a>     dst_ip;</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structMSGHDR" title="BSD message header structure.">MSGHDR</a>  msg;</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a>   iov;</div>
<div class="line">  <span class="keyword">union </span>{</div>
<div class="line">    <a class="code hl_struct" href="group__bsd__structs.html#structCMSGHDR" title="BSD cmsg header structure.">CMSGHDR</a>  cm;</div>
<div class="line">    uint8_t  raw[32];</div>
<div class="line">  } control_un;</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structCMSGHDR" title="BSD cmsg header structure.">CMSGHDR</a> *cmsg;</div>
<div class="line">  int32_t sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  <span class="keywordtype">char</span> enable;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Enable receiving destination IPv4 address</span></div>
<div class="line">    enable = 1;</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7" title="Manipulate options for the socket. [thread-safe].">setsockopt</a> (sock, <a class="code hl_define" href="rl__net_8h.html#abf96615d54d7d81630efc2e8f1770223" title="IPv4 Level.">IPPROTO_IP</a>, <a class="code hl_define" href="rl__net_8h.html#a26a0b420733d6b8d9eed08f5dcdc5940" title="Receive destination IPv4 address.">IP_RECVDSTADDR</a>, &amp;enable, <span class="keyword">sizeof</span>(enable));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Specify receive IO buffer</span></div>
<div class="line">    iov.<a class="code hl_variable" href="group__bsd__structs.html#ae9880e88c5e12cf1ca9319f20782c8ea" title="Starting address.">iov_base</a>    = &amp;dbuf[0];</div>
<div class="line">    iov.<a class="code hl_variable" href="group__bsd__structs.html#a6293656a91579f4d791f1bf4c16f9095" title="Number of bytes to transfer.">iov_len</a>     = <span class="keyword">sizeof</span>(dbuf);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Construct message header</span></div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#a85a0142f5c3b181faa56ff3419d46e5c" title="An array of iovec buffers for the message.">msg_iov</a>         = &amp;iov;</div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#aa46c03bcec753b732482406aa900031c" title="Number of elements in msg_iov.">msg_iovlen</a>      = 1;</div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#a3c2adfa2b4d7aea0174a2d50c30e93fa" title="Optional pointer to source address.">msg_name</a>        = &amp;addr;</div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#a3d8b0a9133a3c6643b972df139bc81d1" title="Size of address buffer.">msg_namelen</a>     = <span class="keyword">sizeof</span>(addr);</div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#ae0bcd626259df3c2f039cee9353150c6" title="Ancillary data.">msg_control</a>     = &amp;control_un.cm;</div>
<div class="line">    msg.<a class="code hl_variable" href="group__bsd__structs.html#a0bd8148dbe690b8629cbc7bdde732575" title="Ancillary data buffer length.">msg_controllen</a>  = <span class="keyword">sizeof</span>(control_un);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga931d8f601c812a4497fc9e00f7e11936" title="Receive a message from a socket. [thread-safe].">recvmsg</a> (sock, &amp;msg, 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Process control data</span></div>
<div class="line">      <span class="keywordflow">for</span> (cmsg = <a class="code hl_define" href="rl__net_8h.html#a326c46eb0fceb09b6ebb075804fd1e0c" title="BSD access ancillary data macros (RFC 2292).">CMSG_FIRSTHDR</a>(&amp;msg); cmsg != NULL; cmsg = <a class="code hl_define" href="rl__net_8h.html#a4f70853d9633fb80428189cd7bb292d0">CMSG_NXTHDR</a>(&amp;msg, cmsg)) {</div>
<div class="line">        <span class="keywordflow">if</span> (cmsg-&gt;<a class="code hl_variable" href="group__bsd__structs.html#a46f8b43dd9e6f87f8608bbab68b4cd90" title="Originating protocol.">cmsg_level</a> == <a class="code hl_define" href="rl__net_8h.html#abf96615d54d7d81630efc2e8f1770223" title="IPv4 Level.">IPPROTO_IP</a> &amp;&amp; cmsg-&gt;<a class="code hl_variable" href="group__bsd__structs.html#a37777698440998ee072c7fb05b98df8b" title="Protocol-specific type.">cmsg_type</a> == <a class="code hl_define" href="rl__net_8h.html#a26a0b420733d6b8d9eed08f5dcdc5940" title="Receive destination IPv4 address.">IP_RECVDSTADDR</a>) {</div>
<div class="line">          <a class="code hl_struct" href="group__bsd__structs.html#structIN__ADDR" title="Generic IPv4 Address structure.">IN_ADDR</a> *pia = (<a class="code hl_struct" href="group__bsd__structs.html#structIN__ADDR" title="Generic IPv4 Address structure.">IN_ADDR</a> *)<a class="code hl_define" href="rl__net_8h.html#a5ab6d56e410ac0904107e84aeb1484cc">CMSG_DATA</a>(cmsg);</div>
<div class="line">          dst_ip.sin_addr.s_addr = pia-&gt;s_addr;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Process normal data</span></div>
<div class="line">      procrec ((uint8_t *)dbuf);</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote IP:   %s\n&quot;</span>, <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga9123668788ba0c48c7ee439f325e728a" title="Convert from network address to a text string. [not_thread-safe].">inet_ntoa</a>(addr.sin_addr));</div>
<div class="line">      printf (<span class="stringliteral">&quot;Remote port: %d\n&quot;</span>, <a class="code hl_define" href="rl__net_8h.html#aaf82f29d63af29bd83e76d8f7122cf47">ntohs</a> (addr.sin_port));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga54ae5d6756952f2844efec876e6290e9" name="ga54ae5d6756952f2844efec876e6290e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54ae5d6756952f2844efec876e6290e9">&#9670;&#160;</a></span>select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t select </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>nfds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *&#160;</td>
          <td class="paramname"><em>readfds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *&#160;</td>
          <td class="paramname"><em>writefds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> *&#160;</td>
          <td class="paramname"><em>errorfds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__structs.html#structtimeval">timeval</a> *&#160;</td>
          <td class="paramname"><em>timeout</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the status of one or more sockets. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nfds</td><td>range of sockets to be checked. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">readfds</td><td>pointer to the set of sockets to check for read.<ul>
<li>NULL for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">writefds</td><td>pointer to the set of sockets to check for write.<ul>
<li>NULL for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">errorfds</td><td>pointer to the set of sockets to check for error.<ul>
<li>NULL for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout</td><td>pointer to maximum time for select to wait.<ul>
<li>NULL for blocking wait for event. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>number of ready sockets (&gt;0)</li>
<li>0 = Operation timed out.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ERROR = Suspend operation failed.</li>
</ul>
</dd></dl>
<p>The function <b>select</b> indicates which of the specified sockets is ready for reading, ready for writing, or has an error condition pending. If the specified condition is false for all of the specified sockets, <b>select</b> blocks, up to the specified timeout interval, until the specified condition is true for at least one of the specified sockets.</p>
<p>The argument <em>nfds</em> specifies the range of sockets to be tested. The <b>select</b> function tests sockets in the range of <span class="XML-Token">0</span> to <em>nfds-1</em>.</p>
<p>The argument <em>readfds</em> specifies the set of sockets to be checked for being ready to read on input, and on output indicates which sockets are ready to read. If the value of <em>readfds</em> is <span class="XML-Token">NULL</span>, the sockets are not checked for being ready to read.</p>
<p>The argument <em>writefds</em> specifies the set of sockets to be checked for being ready to write on input, and on output indicates which sockets are ready to write. If the value of <em>writefds</em> is <span class="XML-Token">NULL</span>, the sockets are not checked for being ready to write.</p>
<p>The argument <em>errorfds</em> specifies the set of sockets to be checked for error conditions pending on input, and on output indicates which sockets have error condition pending. If the value of <em>errorfds</em> is <span class="XML-Token">NULL</span>, the sockets are not checked for error condition pending.</p>
<p>On exit, each set of sockets is modified in place to indicate which sockets actually changed status. Thus, if using <b>select</b> within a loop, the sets must be reinitialized before each call.</p>
<p>The argument <em>timeout</em> specifies a maximum interval to wait for the selection to complete. If the value of <em>timeout</em> is <span class="XML-Token">NULL</span>, the <b>select</b> function blocks until an event occurs. If both members of the <em>timeout</em> structure are <span class="XML-Token">0</span>, <b>select</b> function does not block.</p>
<p>The set of sockets of type <a class="el" href="group__bsd__structs.html#structfd__set">fd_set</a> can be initialized and tested with the following macros:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro name   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#ac9a6234e30e3cb64542eca6dab921a93" title="BSD initialize and test fd_set macros.">FD_SET(fd, set)</a>   </td><td class="markdownTableBodyNone">Sets the bit for the socket <em>fd</em> in the set of sockets specified with <em>set</em>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#ad914a2f676490d92b1f509bb6e93b459">FD_CLR(fd, set)</a>   </td><td class="markdownTableBodyNone">Clears the bit for the socket <em>fd</em> in the set of sockets specified with <em>set</em>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a0d02a891286ee61c9e7ecd291c96567f">FD_ISSET(fd, set)</a>   </td><td class="markdownTableBodyNone">Returns a nonzero value if the bit for the socket <em>fd</em> is set in the set of sockets specified with <em>set</em>, and <span class="XML-Token">0</span> otherwise.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="rl__net_8h.html#a13ea72abe5159156453a8a957d8880cb">FD_ZERO(set)</a>   </td><td class="markdownTableBodyNone">Initialises the set of sockets <em>set</em> to have zero bits for all socket descriptors.   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, sd, res, addrlen;</div>
<div class="line">  <span class="keyword">struct </span><a class="code hl_struct" href="group__bsd__structs.html#structfd__set" title="BSD fd_set structure.">fd_set</a> read_fds;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa" title="Set a socket in a listening mode. [thread-safe].">listen</a> (sock, 1);</div>
<div class="line">    sd = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4" title="Accept connect request for a listening socket. [thread-safe].">accept</a> (sock, NULL, NULL);</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">    sock = sd;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <a class="code hl_define" href="rl__net_8h.html#a13ea72abe5159156453a8a957d8880cb">FD_ZERO</a> (&amp;read_fds);</div>
<div class="line">      <a class="code hl_define" href="rl__net_8h.html#ac9a6234e30e3cb64542eca6dab921a93" title="BSD initialize and test fd_set macros.">FD_SET</a> (sock, &amp;read_fds);</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga54ae5d6756952f2844efec876e6290e9" title="Check the status of one or more sockets. [thread-safe].">select</a> (sock+1, &amp;read_fds, NULL, NULL, NULL);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_define" href="rl__net_8h.html#a0d02a891286ee61c9e7ecd291c96567f">FD_ISSET</a> (sock, &amp;read_fds) {</div>
<div class="line">        <span class="comment">// Data is ready, recv will not block</span></div>
<div class="line">        res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">        <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">        procrec ((uint8_t *)dbuf);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga4cc5678cb81694afc224221063fda9cd" name="ga4cc5678cb81694afc224221063fda9cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4cc5678cb81694afc224221063fda9cd">&#9670;&#160;</a></span>send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t send </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data on already connected socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>pointer to application data buffer to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of data (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait to send data.</li>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes sent (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
<li>BSD_ECONNRESET = Connection reset by the peer.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_EDESTADDRREQ = Destination address required.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_EMSGSIZE = Message too large.</li>
<li>BSD_ENOMEM = Not enough memory.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>send</b> is used to send data on an already connected socket. This function is normally used to send a reliable, ordered stream of data bytes on a <b>SOCK_STREAM</b> socket type. It can also be used to send datagrams on a <b>SOCK_DGRAM</b> socket types.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer containing data to transmit. The buffer data length is not limited in size. If the data length is too large for one packet, the <b>send</b> function will fragment the data and send it in several successive data packets:</p><ul>
<li>In blocking mode, which is enabled by default, this function returns after the data has been successfully queued for transmission.</li>
<li>In non blocking mode, the function returns immediately without blocking the system.</li>
</ul>
<p>The argument <em>len</em> specifies the length of data in bytes. The argument <em>flags</em> specifies the message flags:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_DONTWAIT</span>   </td><td class="markdownTableBodyNone">The function returns with error code <code>BSD_EWOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket   </td></tr>
</table>
<p>Return value, when positive, represents the number of bytes sent, which can be less than <em>len</em>.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents locally detected error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (see <a class="el" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b">connect</a>) </p>

</div>
</div>
<a id="ga7a77bd5e326e02dbc9c2f07684f8c4ff" name="ga7a77bd5e326e02dbc9c2f07684f8c4ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a77bd5e326e02dbc9c2f07684f8c4ff">&#9670;&#160;</a></span>sendmsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t sendmsg </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send a message to endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>pointer to <a class="el" href="group__bsd__structs.html#structMSGHDR">MSGHDR</a> structure containing:<ul>
<li>pointer to target address (NULL for none).</li>
<li>array of application buffer(s) containing the message.</li>
<li>pointer to the ancillary data (NULL for none). </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>0 = for none. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes sent (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTSUP = Operation not supported.</li>
<li>BSD_EDESTADDRREQ = Destination address required.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_EMSGSIZE = Message too large.</li>
<li>BSD_ENOMEM = Not enough memory.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>sendmsg</b> is used to send a message from a <b>SOCK_STREAM</b> or <b>SOCK_DGRAM</b> socket. It is normally used with <b>SOCK_DGRAM</b> sockets because it permits the application to specify the destination address where the message is to be sent to.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>msg</em> is a pointer to the <b>msghdr</b> structure, containing both the destination address and the buffers for the outgoing message.</p>
<ul>
<li>The <em>msg_name</em> member is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure that contains the IP address and port number of the endpoint node. If <em>msg_name</em> is <span class="XML-Token">NULL</span>, the destination address specified with a call to <a class="el" href="group__using__network__sockets__bsd__func.html#ga9feed17ea4fc7449b8159eabc131ed5b">connect</a> function is used.</li>
<li>The <em>msg_namelen</em> member is the address length in bytes.</li>
<li>The <em>msg_iov</em> member is a pointer to scatter/gatther array of type <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em>. This array can specify one or more buffers, containing the data to be sent.</li>
<li>The <em>msg_iovlen</em> member contains the number of <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em> buffers, that are available in the <em><a class="el" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a></em> array.</li>
<li>The <em>msg_control</em> member is a pointer to a buffer, that contains the ancillary data.</li>
<li>The <em>msg_controllen</em> member is the ancillary data length.</li>
<li>The <em>msg_flags</em> member is ignored.</li>
</ul>
<p>The argument <em>flags</em> specifies the message flags.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">char</span> msg1[] = { <span class="stringliteral">&quot;Message part 1&quot;</span> };</div>
<div class="line"><span class="keywordtype">char</span> msg2[] = { <span class="stringliteral">&quot;Message part 2&quot;</span> };</div>
<div class="line"><span class="keywordtype">char</span> msg3[] = { <span class="stringliteral">&quot;Message part 3&quot;</span> };</div>
<div class="line"><a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line"><a class="code hl_struct" href="group__bsd__structs.html#structMSGHDR" title="BSD message header structure.">MSGHDR</a>  msg;</div>
<div class="line"><a class="code hl_struct" href="group__bsd__structs.html#structIOVEC" title="BSD scatter/gather array of items.">IOVEC</a>   iov[3];</div>
<div class="line">  </div>
<div class="line">  sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Specify destination address</span></div>
<div class="line">  addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a> = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">  addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>   = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(1025);</div>
<div class="line">  addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>   = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga57fbb43943b1a1226814c7acf881bf1c" title="Convert from text address to a network address. [thread-safe].">inet_addr</a>(<span class="stringliteral">&quot;10.0.0.1&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Specify message buffers</span></div>
<div class="line">  iov[0].<a class="code hl_variable" href="group__bsd__structs.html#ae9880e88c5e12cf1ca9319f20782c8ea" title="Starting address.">iov_base</a> = &amp;msg1;</div>
<div class="line">  iov[0].<a class="code hl_variable" href="group__bsd__structs.html#a6293656a91579f4d791f1bf4c16f9095" title="Number of bytes to transfer.">iov_len</a>  = strlen(msg1);</div>
<div class="line">  iov[1].<a class="code hl_variable" href="group__bsd__structs.html#ae9880e88c5e12cf1ca9319f20782c8ea" title="Starting address.">iov_base</a> = &amp;msg2;</div>
<div class="line">  iov[1].<a class="code hl_variable" href="group__bsd__structs.html#a6293656a91579f4d791f1bf4c16f9095" title="Number of bytes to transfer.">iov_len</a>  = strlen(msg2);</div>
<div class="line">  iov[2].<a class="code hl_variable" href="group__bsd__structs.html#ae9880e88c5e12cf1ca9319f20782c8ea" title="Starting address.">iov_base</a> = &amp;msg3;</div>
<div class="line">  iov[2].<a class="code hl_variable" href="group__bsd__structs.html#a6293656a91579f4d791f1bf4c16f9095" title="Number of bytes to transfer.">iov_len</a>  = strlen(msg3);</div>
<div class="line">     </div>
<div class="line">  <span class="comment">// Construct message header</span></div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#a85a0142f5c3b181faa56ff3419d46e5c" title="An array of iovec buffers for the message.">msg_iov</a>        = &amp;iov[0];</div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#aa46c03bcec753b732482406aa900031c" title="Number of elements in msg_iov.">msg_iovlen</a>     = 3;</div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#a3c2adfa2b4d7aea0174a2d50c30e93fa" title="Optional pointer to source address.">msg_name</a>       = &amp;addr;</div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#a3d8b0a9133a3c6643b972df139bc81d1" title="Size of address buffer.">msg_namelen</a>    = <span class="keyword">sizeof</span>(addr);</div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#ae0bcd626259df3c2f039cee9353150c6" title="Ancillary data.">msg_control</a>    = NULL;</div>
<div class="line">  msg.<a class="code hl_variable" href="group__bsd__structs.html#a0bd8148dbe690b8629cbc7bdde732575" title="Ancillary data buffer length.">msg_controllen</a> = 0;</div>
<div class="line"> </div>
<div class="line">  res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga7a77bd5e326e02dbc9c2f07684f8c4ff" title="Send a message to endpoint node. [thread-safe].">sendmsg</a> (sock, &amp;msg, 0);</div>
<div class="line">  <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">    <span class="comment">// Error</span></div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gab9207ae37f46c2999ac5765fc6736535" name="gab9207ae37f46c2999ac5765fc6736535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab9207ae37f46c2999ac5765fc6736535">&#9670;&#160;</a></span>sendto()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t sendto </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>tolen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data to endpoint node. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>pointer to application data buffer to transmit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>length of data (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>message flags:<ul>
<li>MSG_DONTWAIT = don't wait to send data.</li>
<li>0 = for none. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>structure containing remote IP address and port. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tolen</td><td>length of <a class="el" href="group__bsd__structs.html#structSOCKADDR">SOCKADDR</a> structure. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Number of bytes sent (&gt;0).</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ELOCKED = Socket locked by another thread.</li>
<li>BSD_ENOTCONN = Socket not connected.</li>
<li>BSD_ECONNRESET = Connection reset by the peer.</li>
<li>BSD_EWOULDBLOCK = Operation would block.</li>
<li>BSD_ETIMEDOUT = Operation timed out.</li>
<li>BSD_EDESTADDRREQ = Destination address required.</li>
<li>BSD_ECONNABORTED = Connection aborted locally.</li>
<li>BSD_EMSGSIZE = Message too large.</li>
<li>BSD_ENOMEM = Not enough memory.</li>
<li>BSD_ERROR = Unspecified error.</li>
</ul>
</dd></dl>
<p>The function <b>sendto</b> is used to send data. It is normally used to send messages on a <b>SOCK_DGRAM</b> socket type, but can also be used to send data on a connected <b>SOCK_STREAM</b> socket type.</p>
<p>If the socket type is <b>SOCK_DGRAM</b> and the socket is not yet bound, the system implicitly binds to a random dynamic port.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>buf</em> is a pointer to the application data buffer containing data to transmit. The buffer data length is not limited in size. If the data length is too large for one packet, the <b>sendto</b> function will fragment the data and send it in several successive data packets:</p><ul>
<li>In blocking mode, which is enabled by default, this function returns after the data has been successfully queued for transmission.</li>
<li>In non blocking mode, the function returns immediately without blocking the system.</li>
</ul>
<p>The argument <em>len</em> specifies the length of data in bytes. The argument <em>flags</em> specifies the message flags: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Flag   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">MSG_DONTWAIT</span>   </td><td class="markdownTableBodyNone">The function returns with error code <code>BSD_EWOULDBLOCK</code> or <b>number of bytes</b> sent instead of blocking the socket   </td></tr>
</table>
<p>The argument <em>to</em> is a pointer to the <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure that contains the endpoint node IP address and port number.</p>
<p>The argument <em>tolen</em> specifies the length of <a class="el" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> structure.</p>
<p>If the socket type is <b>SOCK_STREAM</b>, arguments <em>to</em> and <em>tolen</em> are ignored.</p>
<p>Return value, when positive, represents the number of bytes sent, which can be less than <em>len</em>.</p>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents locally detected error code.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Client_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res, lshift;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line">  uint8_t p2val;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>      = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>    = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b1 = IP1;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b2 = IP2;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b3 = IP3;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_b4 = IP4;</div>
<div class="line"> </div>
<div class="line">    lshift = 1;</div>
<div class="line">    p2val  = 0x01;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      <span class="comment">// Shift the LEDs </span></div>
<div class="line">      LED_SetOut (p2val);</div>
<div class="line">      p2val = lshift ? (p2val &lt;&lt; 1) : (p2val &gt;&gt; 1);</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x80) lshift = 0;</div>
<div class="line">      <span class="keywordflow">if</span> (p2val == 0x01) lshift = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Send the data to LED Server</span></div>
<div class="line">      dbuf[0] = BLINKLED;</div>
<div class="line">      dbuf[1] = p2val;</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gab9207ae37f46c2999ac5765fc6736535" title="Send data to endpoint node. [thread-safe].">sendto</a> (sock, (<span class="keywordtype">char</span> *)&amp;dbuf, 2, 0, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span> (addr));</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt; 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      osDelay (100 * SPEED);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga7a19e669b6bf6f4f82b68d01ff6d4be7" name="ga7a19e669b6bf6f4f82b68d01ff6d4be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a19e669b6bf6f4f82b68d01ff6d4be7">&#9670;&#160;</a></span>setsockopt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t setsockopt </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>optname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>optval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>optlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manipulate options for the socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sock</td><td>socket descriptor obtained with <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">level</td><td>level at which the option is defined:<ul>
<li>SOL_SOCKET = Socket level.</li>
<li>IPPROTO_IP = IPv4 protocol level.</li>
<li>IPPROTO_IPV6 = IPv6 protocol level. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optname</td><td>socket option for which the value is to be set:<ul>
<li>SO_KEEPALIVE = Keep Alive.</li>
<li>SO_RCVTIMEO = Timeout for blocking receive (in ms).</li>
<li>SO_SNDTIMEO = Timeout for blocking send (in ms).</li>
<li>SO_BINDTODEVICE = Network interface to bind (class and number).</li>
<li>IP_TOS = Type of Service (TOS).</li>
<li>IP_TTL = Time to Live (TTL).</li>
<li>IP_RECVDSTADDR = Receive Destination IP Address.</li>
<li>IPV6_TCLASS = Traffic Class.</li>
<li>IPV6_MULTICAST_HOPS = Multi-cast Hop Limit.</li>
<li>IPV6_RECVDSTADDR = Receive Destination IPv6 Address.</li>
<li>IPV6_V6ONLY = Restrict to IPv6 communications only. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optval</td><td>pointer to the buffer containing the option value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">optlen</td><td>size of the buffer containing the option value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>0 = Operation successful.</li>
<li>BSD_ESOCK = Invalid socket descriptor or socket not created.</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ENOTSUP = Option not supported for this socket type.</li>
<li>BSD_ERROR = Option failed, socket already bound.</li>
</ul>
</dd></dl>
<p>The function <b>setsockopt</b> sets options for a socket. Options may exist at multiple protocol levels.</p>
<p>The argument <em>sock</em> specifies a socket descriptor returned from a previous call to <a class="el" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9">socket</a>.</p>
<p>The argument <em>level</em> describes the level at which the option is defined (for example SOL_SOCKET).</p>
<p>The argument <em>optname</em> is the socket option for which the value is to be set. The <em>optname</em> argument must be a socket option defined within the specified <em>level</em>.</p>
<p>The argument <em>optval</em> points to the buffer containing the value of the <em>optname</em>.</p>
<p>The argument <em>optlen</em> tells the exact length of the option.</p>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line"><span class="comment">// Timeout 5 sec</span></div>
<div class="line">int32_t timeout = 5000;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7" title="Manipulate options for the socket. [thread-safe].">setsockopt</a> (sock, <a class="code hl_define" href="rl__net_8h.html#a92d045f6ee2f343d6b28830a9fec082e" title="BSD Socket level.">SOL_SOCKET</a>, <a class="code hl_define" href="rl__net_8h.html#af2d1ed6a34336a6f3df80fb518325846" title="Timeout for blocking receive (in milliseconds)">SO_RCVTIMEO</a>, (<span class="keywordtype">char</span> *)&amp;timeout, <span class="keyword">sizeof</span> (timeout));</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gac01ac0611ef0f7d743e0eb464e7786a9" name="gac01ac0611ef0f7d743e0eb464e7786a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac01ac0611ef0f7d743e0eb464e7786a9">&#9670;&#160;</a></span>socket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>protocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a communication endpoint called socket. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">family</td><td>address family:<ul>
<li>AF_INET = address family IPv4.</li>
<li>AF_INET6 = address family IPv6. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>connection type of a socket:<ul>
<li>SOCK_STREAM = connection based type.</li>
<li>SOCK_DGRAM = datagram connectionless type. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">protocol</td><td>protocol type:<ul>
<li>IPPROTO_TCP = must be used with SOCK_STREAM type.</li>
<li>IPPROTO_UDP = must be used with SOCK_DGRAM TYPE.</li>
<li>0 = for system auto-select. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>Socket descriptor (&gt;0).</li>
<li>BSD_EINVAL = Invalid parameter.</li>
<li>BSD_ENOMEM = No free sockets available.</li>
</ul>
</dd></dl>
<p>The function <b>socket</b> creates a communication endpoint called a socket.</p>
<p>The argument <em>family</em> specifies the address family. Currently, only <a class="el" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826">AF_INET</a> and <a class="el" href="rl__net_8h.html#aa03706b2738b9a58d4985dfbe99e1bac">AF_INET6</a> address families are supported. By default, the IPv4 socket operates over the IPv4 protocol, the IPv6 socket operates over the IPv6 protocol. To convert an IPv6 socket to a dual-stack socket, the <a class="el" href="group__using__network__sockets__bsd__func.html#ga7a19e669b6bf6f4f82b68d01ff6d4be7">setsockopt</a> function must be called with the <a class="el" href="rl__net_8h.html#a48fb8bf5da186346125c2750265b0c65">IPV6_V6ONLY</a> socket option to set this value to zero before the socket is bound to an IP address. When communicating with a dual-stack socket, the socket can operate via both, IPv4 or IPv6.</p>
<p>The argument <em>type</em> specifies the communication semantics. The following are the currently supported types: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">SOCK_STREAM</span>   </td><td class="markdownTableBodyNone">Provides a reliable connection based data stream that is full-duplex    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">SOCK_DGRAM</span>   </td><td class="markdownTableBodyNone">Provides connectionless communication that is unreliable   </td></tr>
</table>
<p>The argument <em>protocol</em> specifies the protocol that must be used with socket type: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Protocol   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">IPPROTO_TCP</span>   </td><td class="markdownTableBodyNone">Must be used with SOCK_STREAM socket type    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><span class="XML-Token">IPPROTO_UDP</span>   </td><td class="markdownTableBodyNone">Must be used with SOCK_DGRAM socket type    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><span class="XML-Token">0</span>   </td><td class="markdownTableBodyNone">The system selects a matching protocol for the socket type   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>You must call the <b>socket</b> function before any other function calls to the BSD socket.</li>
<li>If a negative number is returned, it represents an <b>error</b> <b>code</b>.</li>
</ul>
</dd></dl>
<p><b>Code</b> <b>Example</b> (Stream Socket) </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, sd, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a249394484f9410a2e3f8eba24657feb9" title="BSD Socket Type.">SOCK_STREAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga4dde9362ae7fd2b2a60eeba388874afa" title="Set a socket in a listening mode. [thread-safe].">listen</a> (sock, 1);</div>
<div class="line">    sd = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga34f0c4489df12e0ce4972a78ec3d62b4" title="Accept connect request for a listening socket. [thread-safe].">accept</a> (sock, NULL, NULL);</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">    sock = sd;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_SetOut (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Code</b> <b>Example</b> (Datagram Socket) </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> Server_Thread (<span class="keywordtype">void</span> *arg) {</div>
<div class="line">  <a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR__IN" title="IPv4 Socket Address structure.">SOCKADDR_IN</a> addr;</div>
<div class="line">  int32_t sock, res;</div>
<div class="line">  <span class="keywordtype">char</span> dbuf[4];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (1) {</div>
<div class="line">    sock = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gac01ac0611ef0f7d743e0eb464e7786a9" title="Create a communication endpoint called socket. [thread-safe].">socket</a> (<a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>, <a class="code hl_define" href="rl__net_8h.html#a4db8b9a846c67404db0b6f014f9a9fdf" title="Datagram Socket (Connectionless)">SOCK_DGRAM</a>, 0);</div>
<div class="line"> </div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a17c017619a9612c083063a3438ac4b5e" title="Port.">sin_port</a>        = <a class="code hl_define" href="rl__net_8h.html#af3a256b18d0645af51564e63fec1bbbb" title="Host to network byte order conversion.">htons</a>(PORT_NUM);</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a321ed882a4b4cd66d1b9ad64ababd67e" title="Socket domain.">sin_family</a>      = <a class="code hl_define" href="rl__net_8h.html#a9930604d0e32588eae76f43ca38e7826" title="Internet Address Family.">AF_INET</a>;</div>
<div class="line">    addr.<a class="code hl_variable" href="group__bsd__structs.html#a92b552b33b68a46c97a8d27a13a8bfb6" title="IP address.">sin_addr</a>.s_addr = <a class="code hl_define" href="rl__net_8h.html#a5d1940045dc2e7de552f3d4ff13a74ab" title="BSD Internet Addresses IPv4.">INADDR_ANY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga371b442b92e67a6046b168521d4a1b4a" title="Assign a local address and port to a socket. [thread-safe].">bind</a> (sock, (<a class="code hl_struct" href="group__bsd__structs.html#structSOCKADDR" title="Generic Socket Address structure.">SOCKADDR</a> *)&amp;addr, <span class="keyword">sizeof</span>(addr));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">      res = <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#gaf6d5bc55c3bcbed83a0e03eae48010ba" title="Receive data on already connected socket. [thread-safe].">recv</a> (sock, dbuf, <span class="keyword">sizeof</span> (dbuf), 0);</div>
<div class="line">      <span class="keywordflow">if</span> (res &lt;= 0) {</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (dbuf[0] == BLINKLED) {</div>
<div class="line">        LED_SetOut (dbuf[1]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__using__network__sockets__bsd__func.html#ga50c4d62065c117f425ae2734e7979f21" title="Close socket and release socket descriptor. [thread-safe].">closesocket</a> (sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
