<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network Component: Access and Multi-User Interface</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "Network Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__ftp__access__filter__mui.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Access and Multi-User Interface<div class="ingroups"><a class="el" href="group__netServices.html">Services</a> &raquo; <a class="el" href="group__netFTPs__Func.html">FTP Server</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Functions to filter access to the FTP server and to work with user accounts.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga38c2ff05058bdb0ca8b3c122bffc4bb9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ftp__access__filter__mui.html#ga38c2ff05058bdb0ca8b3c122bffc4bb9">netFTPs_AcceptClient</a> (const <a class="el" href="group__network__structs.html#structNET__ADDR">NET_ADDR</a> *addr)</td></tr>
<tr class="memdesc:ga38c2ff05058bdb0ca8b3c122bffc4bb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept or deny connection from remote FTP client. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:ga38c2ff05058bdb0ca8b3c122bffc4bb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab204f191fe2ed707562ca0246dab0617"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ftp__access__filter__mui.html#gab204f191fe2ed707562ca0246dab0617">netFTPs_CheckUsername</a> (const char *username)</td></tr>
<tr class="memdesc:gab204f191fe2ed707562ca0246dab0617"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an user account exists in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:gab204f191fe2ed707562ca0246dab0617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga100ca730f5e9e891ede74caf51d0ce3a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ftp__access__filter__mui.html#ga100ca730f5e9e891ede74caf51d0ce3a">netFTPs_CheckPassword</a> (uint8_t user_id, const char *password)</td></tr>
<tr class="memdesc:ga100ca730f5e9e891ede74caf51d0ce3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check user account password in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:ga100ca730f5e9e891ede74caf51d0ce3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga946cfca1047c9d91737ba310ba4f2238"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ftp__access__filter__mui.html#ga946cfca1047c9d91737ba310ba4f2238">netFTPs_FileAccess</a> (uint8_t user_id, const char *fname, uint32_t access)</td></tr>
<tr class="memdesc:ga946cfca1047c9d91737ba310ba4f2238"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if remote user is allowed to access a file on FTP server. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:ga946cfca1047c9d91737ba310ba4f2238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10e6ca292ab005d9e9f786ff84f97ae1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ftp__access__filter__mui.html#ga10e6ca292ab005d9e9f786ff84f97ae1">netFTPs_GetUserId</a> (void)</td></tr>
<tr class="memdesc:ga10e6ca292ab005d9e9f786ff84f97ae1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the user identification number. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga10e6ca292ab005d9e9f786ff84f97ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>Functions to filter access to the FTP server and to work with user accounts. </p>
<p>To filter the access to the FTP server based on the IP address and port of the connecting client, the optional function <a class="el" href="group__ftp__access__filter__mui.html#ga38c2ff05058bdb0ca8b3c122bffc4bb9">netFTPs_AcceptClient</a> is used. It is part of the template file <b>FTP_Server_Access.c</b>. If this template file is missing in the project, the function will not be available and thus connections from all remote clients will be accepted. You need to adapt the function to the application's needs by specifying the rules for allowed/blocked clients. The FTP server will use the information in this function to filter the access.</p>
<p>The multi-user login allows you to create different profiles for different users or groups of users. The profiles define the access rights to different files on the FTP server. The users which are allowed to access the FTP server are stored in an user database.</p>
<p>If you want to use multi-user authentication, you need to check the <b>Enable User Authentication</b> in the <a class="el" href="group__using__ftp__server__conf.html">configuration file</a> (<b>Net_Config_FTP_Server.h</b>). The default account is a system administrator account, which has no restrictions. All other accounts are created in a separate <b>FTP_Server_Multiuser.c</b> module. To enable a list of users, you need to adapt the following functions that are included in this module:</p><ul>
<li><a class="el" href="group__ftp__access__filter__mui.html#gab204f191fe2ed707562ca0246dab0617">netFTPs_CheckUsername</a> - checks if the user account exists for the provided credentials.</li>
<li><a class="el" href="group__ftp__access__filter__mui.html#ga100ca730f5e9e891ede74caf51d0ce3a">netFTPs_CheckPassword</a> - checks if the password fits to the user account for the provided credentials.</li>
<li><a class="el" href="group__ftp__access__filter__mui.html#ga946cfca1047c9d91737ba310ba4f2238">netFTPs_FileAccess</a> - check if the access to the file is allowed for a provided user.</li>
</ul>
<p>The following function is included in the Network Component library rl_net.h:</p><ul>
<li><a class="el" href="group__ftp__access__filter__mui.html#ga10e6ca292ab005d9e9f786ff84f97ae1">netFTPs_GetUserId</a> - retrieves the user identification number for the user, which is trying to access the file or folder.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>To add the template files to your project, simply right-click on the Source group, select <b>Add New Item to Group</b>, then click on <b>User Code Template</b> and scroll in the template files list until you find the required template.</li>
<li>If the <b>FTP_Server_Multiuser.c</b> is not added to the project, but Authentication is enabled, the FTP server runs in single user authentication mode (refer to <a class="el" href="group__ftp__user__api.html">Control Interface</a>). </li>
</ul>
</dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga38c2ff05058bdb0ca8b3c122bffc4bb9" name="ga38c2ff05058bdb0ca8b3c122bffc4bb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga38c2ff05058bdb0ca8b3c122bffc4bb9">&#9670;&#160;</a></span>netFTPs_AcceptClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool netFTPs_AcceptClient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__network__structs.html#structNET__ADDR">NET_ADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept or deny connection from remote FTP client. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing IP address and port of remote FTP client. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = Connection from the remote client is allowed.</li>
<li>false = Connection is denied.</li>
</ul>
</dd></dl>
<p>The function <b>netFTPs_AcceptClient</b> checks if a connection from the remote client is allowed or not. This enables remote client filtering. You can selectively decide which clients are allowed to connect to the FTP server and which are not.</p>
<p>The argument <em>addr</em> points to a buffer containing IP address and port of the remote machine.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If missing, the library default function is used which accepts all remote clients.</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>FTP_Server_Access.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__ftp__access__filter__mui.html#ga38c2ff05058bdb0ca8b3c122bffc4bb9" title="Accept or deny connection from remote FTP client. [user-provided].">netFTPs_AcceptClient</a> (<span class="keyword">const</span> <a class="code hl_struct" href="group__network__structs.html#structNET__ADDR" title="Network Address IPv4/IPv6 capable.">NET_ADDR</a> *addr) {</div>
<div class="line">  <span class="keywordflow">if</span> (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a0444de3555073772ebd025a838b9a911" title="IP address type: NET_ADDR_IP4 or NET_ADDR_IP6.">addr_type</a> == <a class="code hl_define" href="rl__net_8h.html#ab5ae61a54f36e338a8dc06cee088d89f" title="IPv4 Address.">NET_ADDR_IP4</a>) {</div>
<div class="line">    <span class="comment">// IPv4 client</span></div>
<div class="line">    <span class="keywordflow">if</span> (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[0] == 192  &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[1] == 168  &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[2] == 0    &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[3] == 1) {</div>
<div class="line">      <span class="comment">// Accept connection from client at 192.168.0.1</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// IPv6 client</span></div>
<div class="line">    <span class="keyword">const</span> uint8_t ip6_addr[<a class="code hl_define" href="rl__net_8h.html#afc2dd6f6b5b737eae868a756d38ed846" title="IPv6 Address Length in bytes.">NET_ADDR_IP6_LEN</a>] = { </div>
<div class="line">                     0xfe, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line">                     0x1c, 0x30, 0x6c, 0xff, 0xfe, 0xa2, 0x45, 0x5e };</div>
<div class="line">    <span class="keywordflow">if</span> (memcmp (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>, ip6_addr, <a class="code hl_define" href="rl__net_8h.html#afc2dd6f6b5b737eae868a756d38ed846" title="IPv6 Address Length in bytes.">NET_ADDR_IP6_LEN</a>) == 0) {</div>
<div class="line">      <span class="comment">// Accept connection from client at [fe80::1c30:6cff:fea2:455e]</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Deny connection.</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">false</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga100ca730f5e9e891ede74caf51d0ce3a" name="ga100ca730f5e9e891ede74caf51d0ce3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga100ca730f5e9e891ede74caf51d0ce3a">&#9670;&#160;</a></span>netFTPs_CheckPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool netFTPs_CheckPassword </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check user account password in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_id</td><td>user identification number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>pointer to password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = password accepted.</li>
<li>false = invalid password.</li>
</ul>
</dd></dl>
<p>The function <b>netFTPs_CheckPassword</b> authenticates the password for a specified user ID.</p>
<p>The argument <em>user_id</em> is the identification number of a user.</p>
<p>The argument <em>password</em> points to the password that gets checked.</p>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>FTP_Server_Multiuser.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__ftp__access__filter__mui.html#ga100ca730f5e9e891ede74caf51d0ce3a" title="Check user account password in the user database. [user-provided].">netFTPs_CheckPassword</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line">  <span class="keywordflow">if</span> (user_id == 1) {</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp (password, <span class="stringliteral">&quot;guest&quot;</span>) == 0) {</div>
<div class="line">      <span class="comment">// Password is correct</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">false</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gab204f191fe2ed707562ca0246dab0617" name="gab204f191fe2ed707562ca0246dab0617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab204f191fe2ed707562ca0246dab0617">&#9670;&#160;</a></span>netFTPs_CheckUsername()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t netFTPs_CheckUsername </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if an user account exists in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>pointer to username. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>User identification number.</li>
<li>0 if the user is not existing.</li>
</ul>
</dd></dl>
<p>The function <b>netFTPs_CheckUsername</b> authenticates the username and returns the corresponding identification number. A value of <span class="XML-Token">0</span> is returned if the user does not exist.</p>
<p>The argument <em>username</em> points to the user name.</p>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>FTP_Server_Multiuser.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line">uint8_t <a class="code hl_function" href="group__ftp__access__filter__mui.html#gab204f191fe2ed707562ca0246dab0617" title="Check if an user account exists in the user database. [user-provided].">netFTPs_CheckUsername</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *username) {</div>
<div class="line">  <span class="keywordflow">if</span> (strcmp (username, <span class="stringliteral">&quot;guest&quot;</span>) == 0) {</div>
<div class="line">    <span class="comment">// Username is correct, return user_id</span></div>
<div class="line">    <span class="keywordflow">return</span> (1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (0);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga946cfca1047c9d91737ba310ba4f2238" name="ga946cfca1047c9d91737ba310ba4f2238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga946cfca1047c9d91737ba310ba4f2238">&#9670;&#160;</a></span>netFTPs_FileAccess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool netFTPs_FileAccess </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>access</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if remote user is allowed to access a file on FTP server. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_id</td><td>user identification number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>full path of a file to access. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">access</td><td>access mode as defined with Network Access definitions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = File access is allowed.</li>
<li>false = File access is denied.</li>
</ul>
</dd></dl>
<p>The function <b>netFTPs_FileAccess</b> checks if file access is allowed for a specific user. This allows access protection of sensitive files. The access to protected files will be blocked for unprivileged users. The error code "550 Access is denied" will be returned to the client if access is not allowed.</p>
<p>The argument <em>user_id</em> is the user identification number as returned by <a class="el" href="group__ftp__access__filter__mui.html#gab204f191fe2ed707562ca0246dab0617">netFTPs_CheckUsername</a>. <em>user_id</em> identifies the user who is trying to access the specified file.</p>
<p>The argument <em>fname</em> points to a buffer containing the file name with path which should be accessed. The file name is a <span class="XML-Token">null</span>-terminated string.</p>
<p>The argument <em>access</em> specifies the requested type of file access:</p><ul>
<li><a class="el" href="rl__net_8h.html#a529356321e4fb9e1040bd87ade1073a1">NET_ACCESS_FILE_READ</a> - File Read is allowed.</li>
<li><a class="el" href="rl__net_8h.html#a5570dc957616d3e4428553d7f283ffa2">NET_ACCESS_FILE_WRITE</a> - File Write is allowed.</li>
<li><a class="el" href="rl__net_8h.html#aad5e59330fe6b3a6910b361b7b9feda3">NET_ACCESS_DIRECTORY_CREATE</a> -Directory Create is allowed.</li>
<li><a class="el" href="rl__net_8h.html#ac644287dd7eb5854094eedf956b9ac5a">NET_ACCESS_DIRECTORY_REMOVE</a> - Directory Remove is allowed.</li>
<li><a class="el" href="rl__net_8h.html#af9163a128bf84a9bdaead3d57ace30a4">NET_ACCESS_DIRECTORY_LIST</a> - Directory List is allowed.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If the FTP file access restriction is not used, this function is not required.</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>FTP_Server_Multiuser.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__ftp__access__filter__mui.html#ga946cfca1047c9d91737ba310ba4f2238" title="Check if remote user is allowed to access a file on FTP server. [user-provided].">netFTPs_FileAccess</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname, uint32_t access) {</div>
<div class="line">  <span class="keywordflow">if</span> (user_id == 1) {</div>
<div class="line">    <span class="keywordflow">if</span> ((strcmp (fname, <span class="stringliteral">&quot;/log/test.txt&quot;</span>) == 0) &amp;&amp; (access == <a class="code hl_define" href="rl__net_8h.html#a5570dc957616d3e4428553d7f283ffa2" title="File Write is allowed.">NET_ACCESS_FILE_WRITE</a>)) {</div>
<div class="line">      <span class="comment">// User &quot;guest&quot; is not allowed to modify or delete &quot;test.txt&quot; in &quot;log&quot; folder</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga10e6ca292ab005d9e9f786ff84f97ae1" name="ga10e6ca292ab005d9e9f786ff84f97ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga10e6ca292ab005d9e9f786ff84f97ae1">&#9670;&#160;</a></span>netFTPs_GetUserId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t netFTPs_GetUserId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the user identification number. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="section return"><dt>Returns</dt><dd>user identification number (0 = system administrator).</dd></dl>
<p>The function <b>netFTPs_GetUserId</b> retrieves the user identification number.</p>
<dl class="section note"><dt>Note</dt><dd>This function returns a value of <span class="XML-Token">0</span> for system administrator account.</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line">uint32_t log_count1;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group__ftp__user__notification.html#ga32dd710872b1d0a7d244af76f942d807" title="Notify the user application about events in FTP server service. [user-provided].">netFTPs_Notify</a> (<a class="code hl_enumeration" href="group__netFTPs__Enums.html#ga4fca916eff390e7ffff378084fbf45b5" title="FTP Server Events.">netFTPs_Event</a> event) {</div>
<div class="line">  <span class="keywordflow">if</span> ((event == <a class="code hl_enumvalue" href="rl__net_8h.html#ga4fca916eff390e7ffff378084fbf45b5a69ff368f2066717ce979768f77cd6030" title="User logged in, session is busy.">netFTPs_EventLogin</a>) &amp;&amp; (<a class="code hl_function" href="group__ftp__access__filter__mui.html#ga10e6ca292ab005d9e9f786ff84f97ae1" title="Retrieve the user identification number. [thread-safe].">netFTPs_GetUserId</a>() == 1)) {</div>
<div class="line">    <span class="comment">// Count user 1 logins</span></div>
<div class="line">    log_count1++;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
