<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network Component: Access and Multi-User Interface</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "Network Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__ws__access__filtering__mui.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Access and Multi-User Interface<div class="ingroups"><a class="el" href="group__netServices.html">Services</a> &raquo; <a class="el" href="group__netHTTP__Func.html">HTTP Server</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Functions to filter access to the HTTP server and to work with user accounts.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaf36a37f99a76e8ca958fbde377cee73d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#gaf36a37f99a76e8ca958fbde377cee73d">netHTTPs_AcceptClient</a> (const <a class="el" href="group__network__structs.html#structNET__ADDR">NET_ADDR</a> *addr)</td></tr>
<tr class="memdesc:gaf36a37f99a76e8ca958fbde377cee73d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept or deny a connection from a remote HTTP client. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:gaf36a37f99a76e8ca958fbde377cee73d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaee074414cedf60bc3d259f6647d67e0d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#gaee074414cedf60bc3d259f6647d67e0d">netHTTPs_CheckAccount</a> (const char *username, const char *password)</td></tr>
<tr class="memdesc:gaee074414cedf60bc3d259f6647d67e0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an user account exist in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:gaee074414cedf60bc3d259f6647d67e0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac3c22aa4f158cba0b5492b3599f34e78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#gac3c22aa4f158cba0b5492b3599f34e78">netHTTPs_GetUserSecret</a> (uint8_t user_id, char *buf, uint32_t buf_len)</td></tr>
<tr class="memdesc:gac3c22aa4f158cba0b5492b3599f34e78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the secret word for the selected user. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:gac3c22aa4f158cba0b5492b3599f34e78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5844644be087d719f4d4f7e7e92993e4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#ga5844644be087d719f4d4f7e7e92993e4">netHTTPs_FileAccess</a> (uint8_t user_id, const char *fname)</td></tr>
<tr class="memdesc:ga5844644be087d719f4d4f7e7e92993e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if remote user is allowed to access a file on HTTP server. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>].  <br /></td></tr>
<tr class="separator:ga5844644be087d719f4d4f7e7e92993e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab61405012e910162d511208ab1d2bc3f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__netStatusErrorCodes.html#ga5675a3b88ee02986ae15ae3bb8135551">netStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#gab61405012e910162d511208ab1d2bc3f">netHTTPs_CalcHashHA1</a> (const char *username, const char *password, char *buf, uint32_t buf_len)</td></tr>
<tr class="memdesc:gab61405012e910162d511208ab1d2bc3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate HA1 hash value for the given credentials. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:gab61405012e910162d511208ab1d2bc3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89c542f8305a5100bfa92ff733b0a31d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ws__access__filtering__mui.html#ga89c542f8305a5100bfa92ff733b0a31d">netHTTPs_GetUserId</a> (void)</td></tr>
<tr class="memdesc:ga89c542f8305a5100bfa92ff733b0a31d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the user identification. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>].  <br /></td></tr>
<tr class="separator:ga89c542f8305a5100bfa92ff733b0a31d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>Functions to filter access to the HTTP server and to work with user accounts. </p>
<p>To filter the access to the HTTP server based on the IP address and port of the connecting client, the optional function <a class="el" href="group__ws__access__filtering__mui.html#gaf36a37f99a76e8ca958fbde377cee73d">netHTTPs_AcceptClient</a> is used. It is part of the template file <b>HTTP_Server_Access.c</b>. If this template file is missing in the ÂµVision project, the function will not be available and thus connections from all remote clients will be accepted. You need to adapt the function to the application's needs by specifying the rules for allowed/blocked clients. The HTTP server will use the information in this function to filter the access.</p>
<p>The multi-user login allows you to create different profiles for different users or groups of users. The profiles define the access rights to different files on the HTTP server. The users which are allowed to access the HTTP server are stored in an user database.</p>
<p>If you want to use multi-user authentication, you need to check the <b>Enable User Authentication</b> in the <a class="el" href="group__ws__configuration.html">configuration file</a> (<b>Net_Config_HTTP_Server.h</b>). The default account is a system administrator account, which has no restrictions. All other accounts are created in a separate <b>HTTP_Server_Multiuser.c</b> module. To enable a list of users, you need to adapt the following functions that are included in this module:</p><ul>
<li><a class="el" href="group__ws__access__filtering__mui.html#gaee074414cedf60bc3d259f6647d67e0d">netHTTPs_CheckAccount</a> - checks if the user account exists for the provided credentials.</li>
<li><a class="el" href="group__ws__access__filtering__mui.html#ga5844644be087d719f4d4f7e7e92993e4">netHTTPs_FileAccess</a> - check if the access to the file is allowed for a provided user.</li>
<li><a class="el" href="group__ws__access__filtering__mui.html#ga89c542f8305a5100bfa92ff733b0a31d">netHTTPs_GetUserId</a> - retrieves the user identification number for the user, which is trying to access the file or folder.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>To add the template files to your project, simply right-click on the Source group, select <b>Add New Item to Group</b>, then click on <b>User Code Template</b> and scroll in the template files list until you find the required template.</li>
<li>If the <b>HTTP_Server_Multiuser.c</b> is not added to the project, but Authentication is enabled, the web server runs in single user authentication mode. </li>
</ul>
</dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaf36a37f99a76e8ca958fbde377cee73d" name="gaf36a37f99a76e8ca958fbde377cee73d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf36a37f99a76e8ca958fbde377cee73d">&#9670;&#160;</a></span>netHTTPs_AcceptClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool netHTTPs_AcceptClient </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__network__structs.html#structNET__ADDR">NET_ADDR</a> *&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept or deny a connection from a remote HTTP client. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addr</td><td>structure containing IP address and port of remote HTTP client. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = Connection from the remote client is allowed.</li>
<li>false = Connection is denied.</li>
</ul>
</dd></dl>
<p>The function <b>netHTTPs_AcceptClient</b> checks if a connection from a remote client is allowed or not. This enables remote client filtering. You can selectively decide which clients are allowed to connect to the web server.</p>
<p>The argument <em>addr</em> points to a buffer containing the IP address and port of the remote machine.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If missing, the library default function is used which accepts all remote clients.</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>HTTP_Server_Access.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__ws__access__filtering__mui.html#gaf36a37f99a76e8ca958fbde377cee73d" title="Accept or deny a connection from a remote HTTP client. [user-provided].">netHTTPs_AcceptClient</a> (<span class="keyword">const</span> <a class="code hl_struct" href="group__network__structs.html#structNET__ADDR" title="Network Address IPv4/IPv6 capable.">NET_ADDR</a> *addr) {</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a0444de3555073772ebd025a838b9a911" title="IP address type: NET_ADDR_IP4 or NET_ADDR_IP6.">addr_type</a> == <a class="code hl_define" href="rl__net_8h.html#ab5ae61a54f36e338a8dc06cee088d89f" title="IPv4 Address.">NET_ADDR_IP4</a>) {</div>
<div class="line">    <span class="comment">// IPv4 client</span></div>
<div class="line">    <span class="keywordflow">if</span> (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[0] == 192  &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[1] == 168  &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[2] == 0    &amp;&amp;</div>
<div class="line">        addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>[3] == 1) {</div>
<div class="line">      <span class="comment">// Accept connection from client at 192.168.0.1</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// IPv6 client</span></div>
<div class="line">    <span class="keyword">const</span> uint8_t ip6_addr[<a class="code hl_define" href="rl__net_8h.html#afc2dd6f6b5b737eae868a756d38ed846" title="IPv6 Address Length in bytes.">NET_ADDR_IP6_LEN</a>] = { </div>
<div class="line">                     0xfe, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line">                     0x1c, 0x30, 0x6c, 0xff, 0xfe, 0xa2, 0x45, 0x5e };</div>
<div class="line">    <span class="keywordflow">if</span> (memcmp (addr-&gt;<a class="code hl_variable" href="group__network__structs.html#a110c5dd7725b86823c9408661a3f854b" title="IPv4 or IPv6 address (array 16 bytes, MSB first)">addr</a>, ip6_addr, <a class="code hl_define" href="rl__net_8h.html#afc2dd6f6b5b737eae868a756d38ed846" title="IPv6 Address Length in bytes.">NET_ADDR_IP6_LEN</a>) == 0) {</div>
<div class="line">      <span class="comment">// Accept connection from client at [fe80::1c30:6cff:fea2:455e]</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Deny connection.</span></div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">false</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gab61405012e910162d511208ab1d2bc3f" name="gab61405012e910162d511208ab1d2bc3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab61405012e910162d511208ab1d2bc3f">&#9670;&#160;</a></span>netHTTPs_CalcHashHA1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__netStatusErrorCodes.html#ga5675a3b88ee02986ae15ae3bb8135551">netStatus</a> netHTTPs_CalcHashHA1 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>buf_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate HA1 hash value for the given credentials. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>username, a null-terminated string. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>password, a null-terminated string. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>buffer to store the hash value to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_len</td><td>length of buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code that indicates the execution status of the function.</dd></dl>
<p>The function <b>netHTTPs_CalcHashHA1</b> calculates the MD5 hash value HA1, which is representend as a hexadecimal string. You can call the function if <b>Digest</b> authentication is used. Saving a password as HA1 hash adds additional security to the application.</p>
<p>The argument <em>username</em> points to the user name, which is a <span class="XML-Token">null</span>-terminated string.</p>
<p>The argument <em>password</em> points to the password, which is a <span class="XML-Token">null</span>-terminated string.</p>
<p>The argument <em>buf</em> points to a buffer that will be used to store the value of HA1 hash.</p>
<p>The argument <em>buf_len</em> specifies the length of the buffer <em>buf</em>, which must be at least <span class="XML-Token">33</span> bytes because the function also adds a <span class="XML-Token">null</span>-termination to the HA1 hash string.</p>
<p>The HA1 hash is calculated as: </p><div class="fragment"><div class="line">HA1 = MD5(username:realm:password)</div>
</div><!-- fragment --><p>The value for <em>realm</em> is from the <a class="el" href="group__ws__configuration.html">Net_Config_HTTP_Server.h</a>.</p>
<p>Possible <a class="el" href="group__netStatusErrorCodes.html#ga5675a3b88ee02986ae15ae3bb8135551">netStatus</a> return values:</p><ul>
<li><em>netOK:</em> HA1 hash calculated successfully.</li>
<li><em>netInvalidParameter:</em> Invalid parameter provided.</li>
<li><em>netError:</em> Digest authentication not enabled in the configuration.</li>
</ul>
<p><b>Code</b> <b>Example</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> buf[33];</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__ws__user__api.html#gaed5c02387e7f21bbcd0114620297c08f" title="Determine if the HTTP server authentication is enabled. [thread-safe].">netHTTPs_LoginActive</a>() == <span class="keyword">true</span>) {</div>
<div class="line">  <a class="code hl_function" href="group__ws__user__api.html#ga7c8ed9136a8b5186762c44371482a7ad" title="Set username of the built-in user account. [thread-safe].">netHTTPs_SetUsername</a> (<span class="stringliteral">&quot;sysadmin&quot;</span>);</div>
<div class="line">  <a class="code hl_function" href="group__ws__access__filtering__mui.html#gab61405012e910162d511208ab1d2bc3f" title="Calculate HA1 hash value for the given credentials. [thread-safe].">netHTTPs_CalcHashHA1</a> (<span class="stringliteral">&quot;sysadmin&quot;</span>, <span class="stringliteral">&quot;a$Min#77&quot;</span>, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line">  <a class="code hl_function" href="group__ws__user__api.html#ga81de241aa2a180471e6d957e5d78a0c0" title="Reset password of the built-in user account. [thread-safe].">netHTTPs_SetPassword</a> (buf);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gaee074414cedf60bc3d259f6647d67e0d" name="gaee074414cedf60bc3d259f6647d67e0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaee074414cedf60bc3d259f6647d67e0d">&#9670;&#160;</a></span>netHTTPs_CheckAccount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t netHTTPs_CheckAccount </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if an user account exist in the user database. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>pointer to username. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>pointer to password. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status information:<ul>
<li>User identification number.</li>
<li>0 if the user is not existing.</li>
</ul>
</dd></dl>
<p>The function <b>netHTTPs_CheckAccount</b> checks if an user account exist in the user database for the provided credentials. It is called from the Network Component's HTTP server to check if the user with provided credentials is allowed to access the web pages or not.</p>
<p>The argument <em>username</em> points to a <span class="XML-Token">null</span>-terminated string representing the user name that was typed in from the browser.</p>
<p>The argument <em>password</em> points to a <span class="XML-Token">null</span>-terminated string representing the password. If the authentication type is <b>Digest</b>, the <em>password</em> is an empty string.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. For single user HTTP authentication or when the HTTP authentication is disabled, this function is not required.</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>HTTP_Server_Multiuser.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line">uint8_t <a class="code hl_function" href="group__ws__access__filtering__mui.html#gaee074414cedf60bc3d259f6647d67e0d" title="Check if an user account exist in the user database. [user-provided].">netHTTPs_CheckAccount</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *username, <span class="keyword">const</span> <span class="keywordtype">char</span> *password) {</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ((strcmp (username, <span class="stringliteral">&quot;guest&quot;</span>) == 0) &amp;&amp; (strcmp (password, <span class="stringliteral">&quot;guest&quot;</span>) == 0)) {</div>
<div class="line">    <span class="comment">// Accept guest account</span></div>
<div class="line">    <span class="keywordflow">return</span> (1);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (0);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga5844644be087d719f4d4f7e7e92993e4" name="ga5844644be087d719f4d4f7e7e92993e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5844644be087d719f4d4f7e7e92993e4">&#9670;&#160;</a></span>netHTTPs_FileAccess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool netHTTPs_FileAccess </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if remote user is allowed to access a file on HTTP server. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_id</td><td>user identification number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fname</td><td>name of a file to access. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>true = File access is allowed.</li>
<li>false = File access is denied.</li>
</ul>
</dd></dl>
<p>The function <b>netHTTPs_FileAccess</b> checks if a file access is allowed for a specified user. This enables access protection of sensitive web pages. Protected web pages will not be displayed for unprivileged users. Instead, the Web server shows "Error Page 403 - Forbidden".</p>
<p>The argument <em>user_id</em> is an user identification number as returned by <a class="el" href="group__ws__access__filtering__mui.html#gaee074414cedf60bc3d259f6647d67e0d">netHTTPs_CheckAccount</a>. It identifies the user who is trying to access the specified file.</p>
<p>The argument <em>fname</em> points to a buffer containing the file name of a file, which the user is trying to access. The file name is a <span class="XML-Token">null</span>-terminated string.</p>
<dl class="section note"><dt>Note</dt><dd>This function is optional. If the HTTP resource access restriction is not used, this function is not required.</dd></dl>
<p><b>Code</b> <b>Example</b> </p>
<p>The following example is available in the user code template file <b>HTTP_Server_Multiuser.c</b>. Customize it to the application's needs.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__ws__access__filtering__mui.html#ga5844644be087d719f4d4f7e7e92993e4" title="Check if remote user is allowed to access a file on HTTP server. [user-provided].">netHTTPs_FileAccess</a> (uint8_t user_id, <span class="keyword">const</span> <span class="keywordtype">char</span> *fname) {</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (user_id == 1) {</div>
<div class="line">    <span class="keywordflow">if</span> (strcmp (fname, <span class="stringliteral">&quot;system.cgi&quot;</span>) == 0) {</div>
<div class="line">      <span class="comment">// User &quot;guest&quot; is not allowed to see &quot;system.cgi&quot;</span></div>
<div class="line">      <span class="keywordflow">return</span> (<span class="keyword">false</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> (<span class="keyword">true</span>);</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
<a id="ga89c542f8305a5100bfa92ff733b0a31d" name="ga89c542f8305a5100bfa92ff733b0a31d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89c542f8305a5100bfa92ff733b0a31d">&#9670;&#160;</a></span>netHTTPs_GetUserId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t netHTTPs_GetUserId </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the user identification. [<a class="el" href="group__function__categories.html#thread-safe">thread-safe</a>]. </p>
<dl class="section return"><dt>Returns</dt><dd>user identification number (0 = system administrator).</dd></dl>
<p>The function <b>netHTTPs_GetUserId</b> retrieves the user identification number when the web pages are protected with user authentication. It can be used to generate a web page, whose content is based on the connected user. This function is normally called from the netCGI_Script function.</p>
<p><b>netHTTPs_GetUserId</b> is a system function that is in the Network Component library.</p>
<dl class="section note"><dt>Note</dt><dd>This function returns a value of 0 for system administrator account.</dd></dl>
<p><b>Code</b> <b>Example</b> </p><div class="fragment"><div class="line">uint16_t <a class="code hl_function" href="group__ws__cgi__script.html#ga5203e3a1a0f95a8b76fb83bec73e4be8" title="Generate dynamic web data based on a CGI script. [user-provided].">netCGI_Script</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *env, <span class="keywordtype">char</span> *buf, uint16_t buf_len, uint32_t *pcgi) {</div>
<div class="line">  uint8_t uid;</div>
<div class="line">  ..</div>
<div class="line">    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line">      <span class="comment">// System password - file &#39;system.cgi&#39; </span></div>
<div class="line">      <span class="keywordflow">switch</span> (env[2]) {</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;0&#39;</span>:</div>
<div class="line">          <span class="comment">// Display the user name on web page. </span></div>
<div class="line">          uid = <a class="code hl_function" href="group__ws__access__filtering__mui.html#ga89c542f8305a5100bfa92ff733b0a31d" title="Retrieve the user identification. [thread-safe].">netHTTPs_GetUserId</a> ();</div>
<div class="line">          len = sprintf((<span class="keywordtype">char</span> *)buf,(<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;env[4],</div>
<div class="line">                        (uid == 0) ? <span class="stringliteral">&quot;admin&quot;</span> : users[uid-1]);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div>
<div class="line">           ..</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">   ..</div>
<div class="line">}  </div>
</div><!-- fragment --> 
</div>
</div>
<a id="gac3c22aa4f158cba0b5492b3599f34e78" name="gac3c22aa4f158cba0b5492b3599f34e78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac3c22aa4f158cba0b5492b3599f34e78">&#9670;&#160;</a></span>netHTTPs_GetUserSecret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void netHTTPs_GetUserSecret </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>user_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>buf_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieve the secret word for the selected user. [<a class="el" href="group__function__categories.html#user-provided">user-provided</a>]. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_id</td><td>user identification number. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>buffer to store the secret word to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_len</td><td>length of buffer.</td></tr>
  </table>
  </dd>
</dl>
<p>The function <b>netHTTPs_GetUserSecret</b> retrieves the user secret word from the user database for the provided user. It is called from the HTTP server of the Network Component if <b>Digest</b> authentication is used.</p>
<p>The argument <em>user_id</em> is the identification number of a user.</p>
<p>The argument <em>buf</em> points to a buffer that will be used to store the value of the secret word.</p>
<p>The argument <em>buf_len</em> specifies the length of the buffer <em>buf</em> which is <span class="XML-Token">33</span> bytes.</p>
<p>The <b>UserSecret</b> is either a plain text password or a MD5 hash value HA1. The length of the string that is returned is used by the Network library to determine the type. The HA1 value should be <span class="XML-Token">32</span> bytes, lowercase hexadecimal. If the length is less than <span class="XML-Token">32</span> bytes, the Network library treats the string as plain text password.</p>
<p>The HA1 hash is calculated as: </p><div class="fragment"><div class="line">HA1 = MD5(username:realm:password)</div>
</div><!-- fragment --><p>For <em>username</em> "guest", <em>realm</em> "Embedded WEB Server" and <em>password</em> "guest" the HA1 is: </p><div class="fragment"><div class="line">MD5(<span class="stringliteral">&quot;guest:Embedded WEB Server:guest&quot;</span>) = <span class="stringliteral">&quot;bd553df9efecf3af93c88843b0f54496&quot;</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This function is optional. For Basic HTTP authentication or when the HTTP authentication is disabled, this function is not required.</dd></dl>
<p><b>Code</b> <b>Example</b> <b>clear-text</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group__ws__access__filtering__mui.html#gac3c22aa4f158cba0b5492b3599f34e78" title="Retrieve the secret word for the selected user. [user-provided].">netHTTPs_GetUserSecret</a> (uint8_t user_id, <span class="keywordtype">char</span> *buf, uint32_t buf_len) {</div>
<div class="line">  <span class="keywordflow">if</span> (user_id == 1) {</div>
<div class="line">    <span class="comment">/* Plain text password */</span></div>
<div class="line">    strcpy (buf, <span class="stringliteral">&quot;guest&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Code</b> <b>Example</b> <b>hash-value</b> </p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group__ws__access__filtering__mui.html#gac3c22aa4f158cba0b5492b3599f34e78" title="Retrieve the secret word for the selected user. [user-provided].">netHTTPs_GetUserSecret</a> (uint8_t user_id, <span class="keywordtype">char</span> *buf, uint32_t buf_len) {</div>
<div class="line">  <span class="keywordflow">if</span> (user_id == 1) {</div>
<div class="line">    <span class="comment">/* Digest HA1 hash value */</span></div>
<div class="line">    strcpy (buf, <span class="stringliteral">&quot;bd553df9efecf3af93c88843b0f54496&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> 
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
