<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Network Component: Migration</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">Network Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "Network Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for IPv4 and IPv6 Networking</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('network_diffs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Migration </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_src_network_diffs"></a> The following sections show how to migrate projects from previous versions of the Middleware:</p>
<ul>
<li><a class="el" href="network_diffs.html#nw_diffs_project_migration">Project Migration</a> describes how to migrate an MDK project from the previous Middleware to the latest version.</li>
<li><a class="el" href="network_diffs.html#mig_nw_configuration">Network Configuration</a> describes the differences in the configuration files of the Network Component.</li>
<li><a class="el" href="network_diffs.html#netDebugStdio">STDIO Debug</a> explains how to use the legacy debug features.</li>
</ul>
<h1><a class="anchor" id="nw_diffs_project_migration"></a>
Project Migration</h1>
<p>There is an easy migration path available for users of the Network Component v7. Simply open the project that is about to be migrated in µVision. The IDE will show an error message that a software component is not available:</p>
<div class="image">
<img src="mig_project_open.png" alt=""/>
<div class="caption">
Error message opening a legacy project</div></div>
<p>This message is shown because the previous variants <b>IPv4 Release</b>/**IPv4 Debug** have been removed. Open the <b>Manage Run-Time Environment</b> window. It will show the same error message in a different way:</p>
<div class="image">
<img src="mig_rte_open.png" alt=""/>
<div class="caption">
Error message in the Run-Time Environment</div></div>
<p>Select a New Component variant <b>MDK</b> to get rid of this validation message:</p>
<div class="image">
<img src="mig_rte_choose_mdk.png" alt=""/>
<div class="caption">
Manually resolve the error message</div></div>
<h2><a class="anchor" id="nw_diffs_update_configs"></a>
Update Configuration Files</h2>
<p>After pressing OK, the Project window will look like this:</p>
<div class="image">
<img src="mig_project_required_changes_new_items.png" alt=""/>
<div class="caption">
Updated Project window</div></div>
<p>Right-clicking each file will give you the update options:</p>
<div class="image">
<img src="mig_config_update_merge.png" alt=""/>
<div class="caption">
Update options for configuration files</div></div>
<p><b>Update Config File</b> will simply copy the new configuration file into your project containing the default settings. The old file with your project's settings will be renamed to Net_Config.h.0000 for example. If you want to manually merge the two files, you can open this backup file (located in the folder RTE\Network) and compare it with the new file line by line.</p>
<p>A better way is to use the option <b>Update Config File and Launch Merge</b>. This option is available for µVision users with version 5.15 and above. Refer to the µVision help  <script>link_ext('uv4_dg_mergetoolmnu');</script> for details.</p>
<p>Not all configuration files require a merge, as many of them are compatible. The section <a class="el" href="network_diffs.html#mig_nw_configuration">Network Configuration</a> describes the differences in more detail.</p>
<h2><a class="anchor" id="nw_diffs_rtx_configuration"></a>
Configure Keil RTX</h2>
<p>If you use <b>RTX v5</b>, you do not need to change the <b>RTX settings</b>, because all resources are statically allocated. Refer to the section <a class="el" href="nw_resource_requirements.html">Resource Requirements</a> for more information.</p>
<h2><a class="anchor" id="nw_diffs_build_and_run"></a>
Build and Run the Network Project</h2>
<p>Finally, after merging the configuration files, you should be able to compile the project and run it on your target hardware:</p>
<div class="image">
<img src="mig_build_ok.png" alt=""/>
<div class="caption">
Error-free build output</div></div>
<h1><a class="anchor" id="mig_nw_configuration"></a>
Network Configuration</h1>
<p>The following screenshots show the previous settings on the left-hand side, while the new settings can be seen on the right-hand side.</p>
<h2><a class="anchor" id="mig_nw_configuration_net_config_c"></a>
Net_Config.c</h2>
<p>The network core configuration file has been changed from <code>Net_Config.c</code> to <code>Net_Config.h</code>.</p>
<div class="image">
<img src="diff_net_config_c.png" alt=""/>
<div class="caption">
Old Net_Config.c vs. new Net_Config.h</div></div>
<ul>
<li><b>Variant</b> selection added:<ul>
<li>IPv4 only</li>
<li>IPv4/IPv6 dual stack</li>
</ul>
</li>
<li><b>net_sys_error()</b> handler function removed</li>
</ul>
<h2><a class="anchor" id="mig_nw_configuration_net_debug"></a>
Net_Debug.c</h2>
<p>The network debug configuration file has been changed from <code>Net_Debug.c</code> to <code>Net_Debug.h</code>.</p>
<div class="image">
<img src="diff_net_debug_c.png" alt=""/>
<div class="caption">
Old Net_Debug.c vs. new Net_Debug.h</div></div>
<ul>
<li><b>Network Debug</b> enable switch added</li>
<li><b>Output Channel</b> selection added:<ul>
<li>Event Recorder</li>
<li>STDIO</li>
<li>STDIO + Timestamp</li>
</ul>
</li>
<li><b>Print Time Stamps</b> option integrated into the <b>Output Channel</b> option</li>
<li><b>Multicast Listener Discovery (MLD)</b> option added</li>
<li><b>net_debug_init()</b> function removed</li>
<li><code>DBG_XXX</code> prefix changed to <code>NET_DEBUG_XXX</code> </li>
</ul>
<h1><a class="anchor" id="netDebugStdio"></a>
STDIO Debug</h1>
<p>STDIO Debug is a legacy debug variant that prints event information as ASCII messages to a standard IO port. It is generally less feature-rich and slower than the debug with <a class="el" href="group__net__evr.html">Event Recorder</a> and is not recommended for new projects.</p>
<p>To enable STDIO debugging together with the Network Component, it is required to create an image that generates event information. The necessary steps are:</p>
<ol type="1">
<li><a class="el" href="network_create_app.html#netDebugConfig">Select Debug mode</a>: in the <code>Net_Config.h</code> enable the <b>Network Debug</b> for the component.</li>
<li>In the RTE management dialog enable <b>CMSIS-Compiler:CORE</b> and <b>CMSIS-Compiler:STDOUT</b> components and select its <b>ITM</b> variant.</li>
<li>Configure the <a class="el" href="network_create_app.html#netDebugLevels">Debug Levels</a>.</li>
<li>Build the application code and download it to the target hardware.</li>
</ol>
<h2><a class="anchor" id="autotoc_md53"></a>
Module IDs</h2>
<p>The owner module of the displayed debug message is identified by the message prefix. The following system and application modules are configurable for debugging:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">ID   </th><th class="markdownTableHeadNone">Module   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYS   </td><td class="markdownTableBodyNone">System Core   </td><td class="markdownTableBodyNone">Handles Network system operation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MEM   </td><td class="markdownTableBodyNone">Memory Management   </td><td class="markdownTableBodyNone">Allocates and releases frame buffers.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ETH   </td><td class="markdownTableBodyNone">ETH Interface   </td><td class="markdownTableBodyNone">Handles Ethernet link.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WIFI   </td><td class="markdownTableBodyNone">WiFi Interface   </td><td class="markdownTableBodyNone">Handles wireless network link.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PPP   </td><td class="markdownTableBodyNone">PPP Interface   </td><td class="markdownTableBodyNone">Handles serial line direct or modem connection PPP link.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SLIP   </td><td class="markdownTableBodyNone">SLIP Interface   </td><td class="markdownTableBodyNone">Handles serial line direct or modem connection SLIP link.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LOOP   </td><td class="markdownTableBodyNone">Loopback Interface   </td><td class="markdownTableBodyNone">Handles localhost loopback interface.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IP4   </td><td class="markdownTableBodyNone">IPv4 Core   </td><td class="markdownTableBodyNone">Processes the IP version 4 network layer.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ICMP   </td><td class="markdownTableBodyNone">Control Message (ICMP)   </td><td class="markdownTableBodyNone">Processes ICMP messages. Best known example is the ping.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ARP   </td><td class="markdownTableBodyNone">Address Resolution (ARP)   </td><td class="markdownTableBodyNone">Handles Ethernet MAC address resolution and caching.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IGMP   </td><td class="markdownTableBodyNone">Group Management (IGMP)   </td><td class="markdownTableBodyNone">Processes IGMP messages, Hosts groups and IP Multicasting.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NBNS   </td><td class="markdownTableBodyNone">NBNS Client   </td><td class="markdownTableBodyNone">The NetBIOS Name Service maintains name access to your hardware.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DHCP   </td><td class="markdownTableBodyNone">DHCP Client   </td><td class="markdownTableBodyNone">Handles automatic configuration of IP address, Net mask, Default Gateway, and Primary and Secondary DNS servers.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IP6   </td><td class="markdownTableBodyNone">IPv6 Core   </td><td class="markdownTableBodyNone">Processes the IP version 6 network layer.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ICMP6   </td><td class="markdownTableBodyNone">Control Message (ICMP6)   </td><td class="markdownTableBodyNone">Processes ICMP version 6 messages. Best known example is the ping.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">NDP   </td><td class="markdownTableBodyNone">Neighbor Discovery (NDP)   </td><td class="markdownTableBodyNone">Handles Neighbor Discovery MAC address resolution and caching.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">MLD   </td><td class="markdownTableBodyNone">Multicast Listener Discovery (MLD)   </td><td class="markdownTableBodyNone">Handles Neighbor Discovery MAC address resolution and caching.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">DHCP6   </td><td class="markdownTableBodyNone">DHCP6 Client   </td><td class="markdownTableBodyNone">Handles automatic configuration of IP address in IP version 6.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">UDP   </td><td class="markdownTableBodyNone">UDP Socket   </td><td class="markdownTableBodyNone">Processes UDP frames.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TCP   </td><td class="markdownTableBodyNone">TCP Socket   </td><td class="markdownTableBodyNone">Processes TCP frames.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BSD   </td><td class="markdownTableBodyNone">BSD Socket   </td><td class="markdownTableBodyNone">Processes TCP and UDP frames via standard BSD Sockets API.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HTTP   </td><td class="markdownTableBodyNone">HTTP Server   </td><td class="markdownTableBodyNone">Delivers web pages on the request to web clients.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">FTP   </td><td class="markdownTableBodyNone">FTP Server   </td><td class="markdownTableBodyNone">Manages the files stored on the server and serves the file requests received from the clients.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">FTPC   </td><td class="markdownTableBodyNone">FTP Client   </td><td class="markdownTableBodyNone">Connects to FTP server to transfer files on the server, and to manage files stored on the server.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TELN   </td><td class="markdownTableBodyNone">Telnet Server   </td><td class="markdownTableBodyNone">Allows remote clients to control the system using the command line interface.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">TFTP   </td><td class="markdownTableBodyNone">TFTP Server   </td><td class="markdownTableBodyNone">A simple service which allows you to send files to or read files from the server.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TFTPC   </td><td class="markdownTableBodyNone">TFTP Client   </td><td class="markdownTableBodyNone">Connects to TFTP server to send or receive files.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SMTP   </td><td class="markdownTableBodyNone">SMTP Client   </td><td class="markdownTableBodyNone">Connects to SMTP server to send emails.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DNS   </td><td class="markdownTableBodyNone">DNS Client   </td><td class="markdownTableBodyNone">Handles the resolution of the IP address from a host name.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SNMP   </td><td class="markdownTableBodyNone">SNMP Agent   </td><td class="markdownTableBodyNone">Manages devices on IP network.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SNTP   </td><td class="markdownTableBodyNone">SNTP Client   </td><td class="markdownTableBodyNone">Manages clock synchronization over the network.   </td></tr>
</table>
<p>An example of the debug output is:</p>
<div class="fragment"><div class="line">015.0 ETH:*** Processing frame ***</div>
<div class="line">015.0 ETH: DstMAC 1E-30-6C-A2-45-5E</div>
<div class="line">015.0 ETH: SrcMAC 00-11-43-A4-FE-40</div>
<div class="line">015.0 ETH: Proto IP4, 66 bytes</div>
<div class="line">015.0 IP4:*** Processing frame ***</div>
<div class="line">015.0 IP4: SrcAddr 192.168.0.5</div>
<div class="line">015.0 IP4: DstAddr 192.168.0.150</div>
<div class="line">015.0 IP4: Proto TCP, Id=0x0622</div>
<div class="line">015.0 IP4: Length 52 bytes</div>
<div class="line">015.0 TCP:*** Processing frame ***</div>
<div class="line">015.0 TCP: Ports  : Src=49232, Dst=80</div>
<div class="line">015.0 TCP: Segment: Seq=0x31EDC88C, Ack=0x0</div>
<div class="line">015.0 TCP: Control: [SYN] Win=8192, Cks=0x0C67</div>
<div class="line">015.0 TCP: Mapped to Socket 1, state LISTEN</div>
<div class="line">015.0 TCP:Process Options, 12 bytes</div>
<div class="line">015.0 TCP: Opt-MSS: 1440</div>
<div class="line">015.0 TCP: SendWin: 8192</div>
<div class="line">015.0 TCP: RTO=4000ms (sa=0, sv=40)</div>
<div class="line">015.0 TCP: Next state SYN_REC</div>
</div><!-- fragment --><p>In the above example, Ethernet, IP and TCP debug messages are enabled:</p>
<ul>
<li>Received Ethernet packets are processed by the Ethernet layer and a debug message containing Ethernet header information is printed out. Ethernet debug information contains source and destination MAC address, Ethernet frame length and Ethernet protocol type.</li>
<li>The packet is then passed to the IP layer. IP layer prints out IP debug messages containing the IP header information such as source and destination IP address, frame length, protocol type etc.</li>
<li>When the IP layer has processed the packet, the packet is passed to the upper TCP layer. TCP layer prints out TCP debug messages containing the TCP header information such as source and destination ports, sequence and acknowledge numbers, checksum value, frame length etc.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>If the debug mode is used on a high traffic LAN, the system might block. Reduce the amount of printed debug messages in <code>Net_Debug.h</code> configuration or disable the debug mode completely.</li>
<li>Printing debug messages blocks out the system task scheduler during the time when the message is being sent from the serial port. The incoming IP packets accumulate in the memory. This soon causes an <b>out of memory</b> error. Any further incoming packets are lost until some memory is released. </li>
</ul>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
