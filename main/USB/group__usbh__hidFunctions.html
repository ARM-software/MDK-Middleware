<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>USB Component: HID: Human Interface Device Class</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">USB Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "USB Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for USB Device and Host Communication</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__usbh__hidFunctions.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Content</a>  </div>
  <div class="headertitle"><div class="title">HID: Human Interface Device Class<div class="ingroups"><a class="el" href="group__usbh.html">USB Host</a> &raquo; <a class="el" href="group__usbh__DevClassFunctions.html">Device Class</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>USB Host functions to support Human Interface Device (HID) USB Devices.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Content</h2></td></tr>
<tr class="memitem:group__usbh__hidFunctions__api"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__usbh__hidFunctions__api.html">User API</a></td></tr>
<tr class="memdesc:group__usbh__hidFunctions__api"><td class="mdescLeft">&#160;</td><td class="mdescRight">User API reference of the Human Interface Device Class. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__usbh__hidFunctions__conf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__usbh__hidFunctions__conf.html">Configuration</a></td></tr>
<tr class="memdesc:group__usbh__hidFunctions__conf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration of the USB Host HID Class. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<p>USB Host functions to support Human Interface Device (HID) USB Devices. </p>
<p>The HID class in the USB Component is used for attaching input devices to your system.</p>
<p>Refer to:</p><ul>
<li><a class="el" href="USB_Classes.html#HID">HID: Human Interface Device Class</a> for an overview of the HID class.</li>
<li><a class="el" href="usbh_example_hid.html">USB Host Keyboard</a> for an example project that uses a HID-compliant keyboard as an input.</li>
</ul>
<p><b>Software Structure</b> <br  />
 The application starts the USB Host by calling <a class="el" href="group__usbh__coreFunctions__api.html#ga4420c0add78ae79e8e7ce035227ef4c5">USBH_Initialize</a>. The USB Host Core will wait until an USB HID device is attached to the system. As soon as this happens it will enumerate the device and it will be ready to be used by the application. The handling of the HID class events is implemented in USBH_HIDn_Thread.</p>
<p>The transmit functions <a class="el" href="group__usbh__hidFunctions__api.html#ga35bdd4f4d943a627050ab052474eeadd">USBH_HID_Read</a> and <a class="el" href="group__usbh__hidFunctions__api.html#ga3a2fb083a4f3a0118d06d68a9c56976f">USBH_HID_Write</a> will be called by the user thread directly to communicate with the HID device.</p>
<div class="mscgraph">
<img src="msc_inline_mscgraph_9.png" alt="msc_inline_mscgraph_9" border="0" usemap="#msc_inline_mscgraph_9.map"/>
<map name="msc_inline_mscgraph_9.map" id="msc_inline_mscgraph_9.map"><area href="group__usbh__coreFunctions__api.html#ga4420c0add78ae79e8e7ce035227ef4c5" shape="rect" coords="31,91,120,104" alt=""/>
<area href="group__usbh__hidFunctions__api.html#ga35bdd4f4d943a627050ab052474eeadd" shape="rect" coords="37,263,114,276" alt=""/>
<area href="group__usbh__hidFunctions__api.html#ga3a2fb083a4f3a0118d06d68a9c56976f" shape="rect" coords="34,314,117,327" alt=""/>
<area href="group__usbh__coreFunctions__api.html#gaf98f4e13ff57a8bf1c49cd46a8034d3f" shape="rect" coords="25,384,126,397" alt=""/>
</map>
</div>
<h2><a class="anchor" id="autotoc_md37"></a>
Implementation</h2>
<p>To <a class="el" href="usbh_create_app.html">create an USB Host</a> with support for the HID class:</p><ul>
<li>Select <b>USB:Host:HID</b> in the <a class="el" href="usbh_create_app.html#RTE_Software_Component_Selection_USBH">RTE Component Selection</a>.</li>
<li>Configure the number of USB HID devices connected in the file <a class="el" href="group__usbh__hidFunctions__conf.html">USBH_Config_HID.h</a>.</li>
</ul>
<p><b>Code Example</b> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">void</span>) {</div>
<div class="line">  <a class="code hl_enumeration" href="group__status__error__codes__usb.html#ga8196235c97e113f17993c7b4baff5f8f" title="Status code values returned by USB library functions.">usbStatus</a> usb_status;                 <span class="comment">// USB status</span></div>
<div class="line">  <span class="keywordtype">int</span>       status;                     <span class="comment">// Generic status</span></div>
<div class="line">  <span class="keywordtype">int</span>       ch;                         <span class="comment">// Character</span></div>
<div class="line">  uint8_t   con = 0U;                   <span class="comment">// Connection status of keyboard</span></div>
<div class="line"> </div>
<div class="line">  SystemCoreClockUpdate();              <span class="comment">// Update system clock</span></div>
<div class="line"> </div>
<div class="line">  status = stdout_init ();              <span class="comment">// Initialize retargeted stdout</span></div>
<div class="line">  <span class="keywordflow">if</span> (status != 0) {</div>
<div class="line">    <span class="keywordflow">for</span> (;;) {}                         <span class="comment">// Handle stdout init failure</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  usb_status = <a class="code hl_function" href="group__usbh__coreFunctions__api.html#ga4420c0add78ae79e8e7ce035227ef4c5" title="Initialize USB Host stack and controller.">USBH_Initialize</a> (0U);    <span class="comment">// Initialize USB Host 0</span></div>
<div class="line">  <span class="keywordflow">if</span> (usb_status != <a class="code hl_enumvalue" href="rl__usb_8h.html#ga8196235c97e113f17993c7b4baff5f8facfe6cb72ed8e7b8e95a38cbf95418dbf" title="Function completed with no error.">usbOK</a>) {</div>
<div class="line">    <span class="keywordflow">for</span> (;;) {}                         <span class="comment">// Handle USB Host 0 init failure</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (;;) {</div>
<div class="line">    usb_status= <a class="code hl_function" href="group__usbh__hidFunctions__api.html#ga87af2b86ae68781e915cc887d9c6ac67" title="Get status of Human Interface Device.">USBH_HID_GetStatus</a>(0U); <span class="comment">// Get HID device status</span></div>
<div class="line">    <span class="keywordflow">if</span> (usb_status == <a class="code hl_enumvalue" href="rl__usb_8h.html#ga8196235c97e113f17993c7b4baff5f8facfe6cb72ed8e7b8e95a38cbf95418dbf" title="Function completed with no error.">usbOK</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (con == 0U) {                  <span class="comment">// If keyboard was not connected previously</span></div>
<div class="line">        con = 1U;                       <span class="comment">// Keyboard got connected</span></div>
<div class="line">        printf (<span class="stringliteral">&quot;Connect!\n&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (con == 1U) {                  <span class="comment">// If keyboard was connected previously</span></div>
<div class="line">        con = 0U;                       <span class="comment">// Keyboard got disconnected</span></div>
<div class="line">        printf (<span class="stringliteral">&quot;\nDisconnect!\n&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (con != 0U) {                    <span class="comment">// If keyboard is active</span></div>
<div class="line">      ch = <a class="code hl_function" href="group__usbh__hidFunctions__api.html#ga26b69d81b39f1f13c1fa7e8fec33507e" title="Retrieve first pending pressed keyboard key on HID Keyboard.">USBH_HID_GetKeyboardKey</a> (0U);<span class="comment">// Get pressed key</span></div>
<div class="line">      <span class="keywordflow">if</span> (ch != -1) {                   <span class="comment">// If valid key value</span></div>
<div class="line">        <span class="keywordflow">if</span> ((ch &amp; 0x10000) != 0) {      <span class="comment">// Handle non-ASCII translated keys (Keypad 0 .. 9)</span></div>
<div class="line">                                        <span class="comment">// Bit  16:    non-ASCII bit (0 = ASCII, 1 = not ASCII)</span></div>
<div class="line">                                        <span class="comment">// Bits 15..8: modifiers (SHIFT, ALT, CTRL, GUI)</span></div>
<div class="line">                                        <span class="comment">// Bits  7..0: ASCII or HID key Usage ID if not ASCII</span></div>
<div class="line">          ch &amp;= 0xFF;                   <span class="comment">// Remove non-ASCII bit and modifiers</span></div>
<div class="line">          <span class="keywordflow">if</span> ((ch&gt;=0x59)&amp;&amp;(ch&lt;=0x61)) { <span class="comment">// Keypad 1 .. 9 key convert to</span></div>
<div class="line">            ch = (ch - 0x59) + <span class="charliteral">&#39;1&#39;</span>;     <span class="comment">// ASCII  1 .. 9</span></div>
<div class="line">          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == 0x62) {      <span class="comment">// Keypad 0 key convert to</span></div>
<div class="line">            ch = <span class="charliteral">&#39;0&#39;</span>;                   <span class="comment">// ASCII  0</span></div>
<div class="line">          } <span class="keywordflow">else</span> {                      <span class="comment">// If not Keypad 0 .. 9</span></div>
<div class="line">            ch = -1;                    <span class="comment">// invalidate the key</span></div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> ((ch &gt; 0) &amp;&amp; (ch &lt; 128)) {   <span class="comment">// Output ASCII 0 .. 127 range</span></div>
<div class="line">          putchar(ch);</div>
<div class="line">          fflush(stdout);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    osDelay(10U);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
