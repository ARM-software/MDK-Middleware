<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>USB Component: USB Host Computer Applications</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">USB Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "USB Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for USB Device and Host Communication</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('usb_sw_utilities.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">USB Host Computer Applications </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Most of the available USB Device Classes are directly supported in operating systems. There is no need to install a particular driver on the USB Host Computer to connect to the USB Device peripheral.</p>
<p>Some software needs to be written for the USB Host Computer when USB Driver classes are used to provide application specific functionality. For example, the USB HID Device Class may be used for generic data exchange. Therefore the data exchange interface needs to be developed at the USB Host Computer.</p>
<p>Refer to the following web pages for more information on USB Host software development:</p><ul>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/" class="el" target="_blank">USB Serial Bus (USB)</a> for Microsoft Windows.</li>
<li><a href="http://www.linux-usb.org/" class="el" target="_blank">Linux USB Project</a> for Linux based operating systems.</li>
<li><a href="https://developer.apple.com/documentation/driverkit" class="el" target="_blank">DriverKit</a> for Apple OS.</li>
</ul>
<h2><a class="anchor" id="autotoc_md70"></a>
Software Utilities</h2>
<p>The USB Component comes with a set of software utilities that you can use as templates to create your own programs for the USB Host computer. The utilities are specific for the different USB Device Classes. These are the available utilities:</p><ul>
<li>The <a class="el" href="usb_sw_utilities.html#hid_client_app">HID Client</a> can be used to interact with an USB HID Device. You can toggle LEDs on the development board and check the state of the on-board push-buttons.</li>
<li>The <a class="el" href="usb_sw_utilities.html#winusb_app">WinUSB Test</a> can be used to test the connection between the USB Host PC and the client device. This application uses WinUSB driver on the USB Host PC and demonstrates the basics of using the Microsoft Foundation Classes and can be used as a starting point for writing your application.</li>
</ul>
<h1><a class="anchor" id="hid_client_app"></a>
HID Client</h1>
<p>If you are using the <a class="el" href="dev_hid_tutorial.html">USB Device HID</a> code, there's a way to test the functionality of that code together with a Windows PC. The <b>HIDClient.exe</b> utility is located in "install_dir\ARM\Utilities\HID_Client\Release" folder (where "install_dir" refers to the installation directory of Arm Keil MDK, default "C:\Keil_v5") and can run stand-alone without the need to install the software. To check the client utility with your board, do the following:</p><ol type="1">
<li>Download the USB Device <b>HID</b> application to your board.</li>
<li>Verify all jumper settings on the board.</li>
<li>Connect the board to a Windows PC. The PC should recognize the HID device and install the correct driver automatically.</li>
<li>Run <b>HIDClient.exe</b>.</li>
<li>Select the <b>Device</b> to establish the communication channel.</li>
<li>Test the application by pressing the correct buttons (refer to the application's <b>Abstract.txt</b> file) on your development board and/or check the right boxes in the client application to see the LEDs flashing.</li>
</ol>
<div class="image">
<img src="hid_client_test.png" alt=""/>
</div>
<h2><a class="anchor" id="client_app_cpp"></a>
HID Client Source Code</h2>
<p>The source code of the HID Client application is available in "install_dir\ARM\Utilities\HID_Client". Visual Studio 2005 and 2010 based projects are available (HIDClient.vproj). The structure of the project is as follows:</p>
<div class="image">
<img src="HIDClientSolutionExplorer.png" alt=""/>
</div>
<h2><a class="anchor" id="autotoc_md71"></a>
Header Files</h2>
<ul>
<li><b>HID.h</b> includes the function declarations of the functions that are defined in <b>HID.cpp</b>.</li>
<li><b>HIDClient.h</b> is the main header file for the application. It includes other project specific headers (including Resource.h) and declares the <b>CHIDClientApp</b> application class.</li>
<li><b>HIDClientDlg.h</b> defines the behavior of the application's main dialog.</li>
</ul>
<h2><a class="anchor" id="autotoc_md72"></a>
Resource Files</h2>
<ul>
<li><b>HIDClient.ico</b> is an icon file, which is used as the application's icon. This icon is included by the main resource file <b>HIDClient.rc</b>.</li>
<li><b>HIDClient.rc2</b> contains resources that are not edited by Microsoft Visual C++. You should place all resources not editable by the resource editor in this file.</li>
</ul>
<h2><a class="anchor" id="autotoc_md73"></a>
Source Files</h2>
<ul>
<li><b>HID.cpp</b> contains the necessary functions that are used in this example application to communicate with an USB HID device. All available functions in Windows for HID interaction are explained here: <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/hid/introduction-to-hid-concepts" class="el" target="_blank">Introduction to HID Concepts</a>. The function:<ul>
<li><b>HID_Init</b> initializes the HID class to be used with the USB Host.</li>
<li><b>HID_UnInit</b> de-initializes the HID class from the USB Host.</li>
<li><b>HID_FindDevices</b> scans the USB Bus and lists all available HID devices for connection to the application. This information is obtained from the <a class="el" href="USB_Device_Descriptor.html">Device Descriptor</a> that is generated by the USB Component using the configuration files.</li>
<li><b>HID_GetName</b> evaluates the <a class="el" href="group__usbd.html#prod_string">Product String</a> of the device to be shown in the drop down box of the application.</li>
<li><b>HID_GetInputReportSize</b> extracts the value of <code>USBD_HIDn_IN_REPORT_MAX_SZ</code> as specified in the <a class="el" href="group__usbd__hidFunctions__conf.html">USBD_Config_HID_n.h</a> file.</li>
<li><b>HID_GetOutputReportSize</b> extracts the value of <code>USBD_HIDn_OUT_REPORT_MAX_SZ</code> as specified in the <a class="el" href="group__usbd__hidFunctions__conf.html">USBD_Config_HID_n.h</a> file.</li>
<li><b>HID_GetFeatureReportSize</b> extracts the value of <code>USBD_HIDn_FEAT_REPORT_MAX_SZ</code> as specified in the <a class="el" href="group__usbd__hidFunctions__conf.html">USBD_Config_HID_n.h</a> file.</li>
<li><b>HID_Open</b> opens the device.</li>
<li><b>HID_GetSelectedDevice</b> returns the selected device.</li>
<li><b>HID_Close</b> closes the device.</li>
<li><b>HID_Read</b> initiates a <a class="el" href="group__usbd__hidFunctions__api.html#gaed8b507a9ce1bf958fbcae55ee0b91bf">USBD_HIDn_GetReport</a> within the device to send data to the USB Host.</li>
<li><b>HID_Write</b> triggers a <a class="el" href="group__usbd__hidFunctions__api.html#gab7d101077f2018ca8a24da7dffce434f">USBD_HIDn_SetReport</a> within the device to read data sent from the USB Host.</li>
<li><b>HID_GetFeature</b> and <b>HID_SetFeature</b> work on the USB HID Device's feature report (which is optional).</li>
</ul>
</li>
<li><b>HIDClient.cpp</b> is the main application source file that contains the application class <b>CHIDClientApp</b>.</li>
<li><b>HIDClient.rc</b> is a listing of all of the Microsoft Windows resources that the program uses (located in the res subdirectory).</li>
<li><b>HIDClientDlg.cpp</b> implements the code of the client's dialog and calls the functions specified in <b>HID.cpp</b>. This is the actual place where the interaction between the USB Host and the USB Device is defined.</li>
</ul>
<h1><a class="anchor" id="winusb_app"></a>
WinUSB Test</h1>
<p>If you are following the <a class="el" href="dev_cc_tutorial.html">Custom USB Device (WinUSB_Echo)</a> tutorial, you can test the connection between your custom class USB device and a Microsoft Windows PC with this application. The binary <b>WinUSB_Test.exe</b> (which does not require installation) is available in the "install_dir\ARM\PACK\Keil\MDK-Middleware\x.y.z\Utilities\WinUSB_Test\Release" folder (where "install_dir" refers to the installation directory of Arm Keil MDK, default "C:\Keil_v5" and x &gt;= 7, y &gt;= 5, z &gt;= 0).</p>
<p>To check the WinUSB utility with your board, do the following:</p><ol type="1">
<li>Download the USB Device <b>WinUSB_Echo</b> application to your board.</li>
<li>Verify all jumper settings on the board.</li>
<li>Connect the board to a Windows PC. The PC should recognize the WinUSB device and install the correct driver automatically.</li>
<li>Run <b>WinUSB_Test.exe</b>.</li>
<li>Select the <b>Device</b> to establish the communication channel.</li>
<li>For further settings and tests refer to <a class="el" href="dev_cc_tutorial.html">Custom USB Device (WinUSB_Echo)</a></li>
</ol>
<div class="image">
<img src="WinUSB_Test_application.png" alt=""/>
</div>
<p> <br  />
 </p>
<h2><a class="anchor" id="winusb_app_cpp"></a>
WinUSB application source code</h2>
<p>The WinUSB source code can be found in "install_dir\ARM\PACK\Keil\MDK-Middleware\x.y.z\Utilities\WinUSB_Test". A Visual Studio 2010 (or later) based solution named WinUSB_Test.sln is available. The following is a summary of what you will find in each of the files that make up your WinUSB_Test application.</p>
<div class="image">
<img src="WinUSB_test_sln.png" alt=""/>
</div>
<h2><a class="anchor" id="autotoc_md74"></a>
Header Files</h2>
<ul>
<li><b>.\USB\WinUsbIF.h</b> includes the function declarations of the functions that are defined in <b>.\USB\WinUsbIF.cpp</b>.</li>
<li><b>.\WinUSB_Test\WinUSB_Test.h</b> is the main header file for the application. It includes other project specific headers (including resource.h) and declares the <b>CWinUSB_TestApp</b> application class.</li>
<li><b>.\WinUSB_Test\WinUSB_TestDlg.h</b> defines the behavior of the application's main dialog.</li>
</ul>
<h2><a class="anchor" id="autotoc_md75"></a>
Resource Files</h2>
<ul>
<li><b>.\WinUSB_Test\res\WinUSB_Test.ico</b> is an icon file, which is used as the application's icon. This icon is included by the main resource file <b>.\WinUSB_Test\WinUSB_Test.rc</b>.</li>
<li><b>.\WinUSB_Test\res\Refresh_grey.ico</b> is an icon file, which is used for the refresh button in the application.</li>
<li><b>.\WinUSB_Test\res\WinUSB_Test.rc2</b> contains resources that are not edited by Microsoft Visual C++. You should place all resources not editable by the resource editor in this file.</li>
</ul>
<h2><a class="anchor" id="autotoc_md76"></a>
Source Files</h2>
<ul>
<li><b>.\USB\WinUsbIF.cpp</b> contains the necessary functions that are used in this example application to communicate with a USB device via the WinUSB interface. Refer to the <a href="https://learn.microsoft.com/en-us/windows/win32/api/winusb/" class="el" target="_blank">WinUSB Functions</a> documentation for an overview of the available functions. The function:<ul>
<li><b>WinUsbIF_Initialize</b> initializes the WinUSB interface to be used with the USB Host.</li>
<li><b>WinUsbIF_Uninitialize</b> de-initializes the WinUSB interface from the USB Host.</li>
<li><b>WinUsbIF_SetGUID</b> sets the USB interface Globally Unique Identifier (GUID).</li>
<li><b>WinUsbIF_GetGUID</b> retrieves the USB interface Globally Unique Identifier (GUID).</li>
<li><b>WinUsbIF_FindDevices</b> scans the USB Bus and lists all available devices, containing interface with set GUID, for connection to the application.</li>
<li><b>WinUsbIF_GetNumOfInterfaces</b> retrieves the number of interfaces available for a device.</li>
<li><b>WinUsbIF_GetEndpointsMask</b> retrieves the endpoint mask of the selected device.</li>
<li><b>WinUsbIF_GetName</b> evaluates the VID + PID + Serial Number or Unique ID of the device to be shown in the drop down box of the application.</li>
<li><b>WinUsbIF_GetManufacturerString</b> retrieves the device's manufacturer string.</li>
<li><b>WinUsbIF_GetProductString</b> retrieves the device's product string.</li>
<li><b>WinUsbIF_GetSerialNumberString</b> retrieves the device's serial number string.</li>
<li><b>WinUsbIF_GetInterfaceString</b> retrieves the device's interface string.</li>
<li><b>WinUsbIF_GetVID</b> retrieves the device's vendor ID.</li>
<li><b>WinUsbIF_GetPID</b> retrieves the device's product ID.</li>
<li><b>WinUsbIF_OpenDevice</b> opens the device for USB communication.</li>
<li><b>WinUsbIF_CloseDevice</b> closes the device from USB communication.</li>
<li><b>WinUsbIF_ControlTransfer</b> executes a control transfer on the USB Bus.</li>
<li><b>WinUsbIF_WritePipe</b> executes an USB OUT transfer on a selected pipe to a bulk or interrupt endpoint of the device.</li>
<li><b>WinUsbIF_ReadPipe</b> executes an USB IN transfer on a selected pipe to a bulk or interrupt endpoint of the device.</li>
<li><b>WinUsbIF_AbortPipe</b> aborts pending pipe transfers.</li>
<li><b>WinUsbIF_FlushPipe</b> flushes the cached data of a pipe.</li>
<li><b>WinUsbIF_ResetPipe</b> resets a pipe.</li>
<li><b>WinUsbIF_GetOverlappedResult</b> retrieves the overlapped result.</li>
</ul>
</li>
<li><b>.\WinUSB_Test\WinUSB_Test.cpp</b> is the main application source file that contains the application class <b>CWinUSB_TestApp</b>.</li>
<li><b>.\WinUSB_Test\WinUSB_Test.rc</b> is a listing of all of the Microsoft Windows resources that the program uses (located in the <b>.\WinUSB_Test\res</b> subdirectory).</li>
<li><b>.\WinUSB_Test\WinUSB_TestDlg.cpp</b> implements the code of the client's dialog and calls the functions specified in <b>.\USB\WinUsbIF.cpp</b>. This is the actual place where the interaction between the USB Host and the USB Device is defined. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
