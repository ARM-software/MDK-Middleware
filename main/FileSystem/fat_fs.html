<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>File System Component: FAT File System</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">File System Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "File System Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for Devices with Flash File System</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('fat_fs.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">FAT File System </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The FAT File System was initially used on PC operating systems such as MS-DOS and early versions of Microsoft Windows. Still, it is widely used on <b>USB memory sticks</b> or <b>memory cards</b> for file storage. It is simple, robust and offers good performance especially in embedded applications.</p>
<p>FAT is an acronym for <b>File Allocation Table</b>. This table provides the index of the files in the system and is statically allocated at the time of formatting the drive. It contains an entry for each cluster (a data storage area). The FAT's entries contain either the number of the next cluster in the file, or a marker indicating EOF (end of file), unused disk space, or other areas of the drive that are specially reserved. The drive's root directory contains the number of the first cluster of each file in the directory; the operating system traverses the FAT table, looking up the cluster number of each successive part of the file, until the end of the file is reached. Likewise, sub-directories are implemented as special files containing the directory entries of their respective files.</p>
<p>Since the first implementation, the maximum number of clusters of a drive has increased dramatically, and so the number of bits used to identify each cluster has grown. The versions of the FAT format are named after the number of table element bits: <b>FAT12</b>, <b>FAT16</b>, and <b>FAT32</b>. Each of these variants is is supported by the File System Component.</p>
<h1><a class="anchor" id="fat_layout"></a>
Layout</h1>
<p>The actual FAT file system is made up of four different sections: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Section   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Boot sector   </td><td class="markdownTableBodyLeft">Contains machine startup code    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">File Allocation Table   </td><td class="markdownTableBodyLeft">Contains the data region map; multiple entries might exist for redundancy purposes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Root Directory   </td><td class="markdownTableBodyLeft">Stores information about the files and directories located in the root directory (FAT12/FAT16 only)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">File Data Region   </td><td class="markdownTableBodyLeft">Actual stored file data   </td></tr>
</table>
<h1><a class="anchor" id="fat_volume_label"></a>
Volume name</h1>
<p>Volume label for FAT12, FAT16 or FAT32 volume must be maximum 11 characters long and cannot contain the * ? / \ | , ; : + = &lt; &gt; [ ] " characters.</p>
<h1><a class="anchor" id="fat_path_handling"></a>
Path name handling</h1>
<p>Path name format used to specify either a drive, directory or file:</p><ul>
<li><b>[drive:][directory separator][path]</b></li>
</ul>
<p>Depending on the usage case, each specifier can be optional:</p><ul>
<li>drive specifier must consist of drive letter followed by optional drive number and a semicolon.</li>
<li>directory separator can be slash (/) or backslash (\)</li>
<li>path can consist of multiple directory names and a file name</li>
</ul>
<h2><a class="anchor" id="fat_abs_rel_path"></a>
Absolute and relative path</h2>
<p>The table below explains how to specify either absolute or relative path.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Path name   </th><th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">\   </td><td class="markdownTableBodyLeft">Absolute   </td><td class="markdownTableBodyLeft">Root directory    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">\ ..   </td><td class="markdownTableBodyLeft">Absolute   </td><td class="markdownTableBodyLeft">Root directory    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">.   </td><td class="markdownTableBodyLeft">Relative   </td><td class="markdownTableBodyLeft">Current directory    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">..   </td><td class="markdownTableBodyLeft">Relative   </td><td class="markdownTableBodyLeft">Parent directory    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">M:\file.txt   </td><td class="markdownTableBodyLeft">Absolute   </td><td class="markdownTableBodyLeft">A file in root directory of the drive M0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">M:file.txt   </td><td class="markdownTableBodyLeft">Relative   </td><td class="markdownTableBodyLeft">A file in current directory of the drive M0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">\file.txt   </td><td class="markdownTableBodyLeft">Absolute   </td><td class="markdownTableBodyLeft">A file in the root directory of the current drive    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">file.txt   </td><td class="markdownTableBodyLeft">Relative   </td><td class="markdownTableBodyLeft">A file in the current directory of the current drive    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">folder1\ ..   </td><td class="markdownTableBodyLeft">Relative   </td><td class="markdownTableBodyLeft">Current directory   </td></tr>
</table>
<h1><a class="anchor" id="lfn_sfn_handling"></a>
Long and Short File Name handling</h1>
<p>File System Component is provided with the long (LFN) and short (SFN or 8.3) filename support. Since there is no compulsory algorithm for creating the 8.3 name from an LFN, File System Component uses convention described below.</p>
<ul>
<li>Uppercased or lowercased name which is 8.3 valid, is stored uppercased in a single SFN entry<ul>
<li>Example: "TEXTFILE.TXT" is stored as "TEXTFILE.TXT" (SFN)</li>
<li>Example: "textfile.txt" is stored as "TEXTFILE.TXT" (SFN)</li>
</ul>
</li>
<li>Mixedcase name which is 8.3 valid, is stored mixed-case in LFN entry and SFN entry is created, which is concluded with tilde and a numeric value.<ul>
<li>Example: "TextFile.txt" is stored as "TextFile.txt" (LFN) and "TEXTFI~1.TXT" (SFN)</li>
</ul>
</li>
<li>Name which is not 8.3 valid is stored in LFN entry and SFN entry. Name writen in SFN entry is uppercased, stripped of invalid 8.3 characters which are replaced with underscore "_" and concluded with tilde and a numeric value.<ul>
<li>Example: "Tex+File.txt" is stored as "Tex+File.txt" (LFN) and "TEX_FI~1.TXT (SFN)"</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="fat_time_stamping"></a>
Time Stamping Support</h1>
<p>The File System Component fully supports time stamping for files and directories. it supports:</p><ul>
<li>Create time</li>
<li>Create date</li>
<li>Last access date</li>
<li>Write time</li>
<li>Write date</li>
</ul>
<p>To be able to use the time information provided by an on-chip RTC, the user application needs to implement the function <a class="el" href="group__file__time__routines.html#gafe26294de82a7597b98e3ff45ea2004e">fs_get_time()</a>. The <a class="el" href="rl__fs_8h.html#structfsTime">fsTime</a> structure must be filled with the data returned from the RTC driver. If the <a class="el" href="group__file__time__routines.html#gafe26294de82a7597b98e3ff45ea2004e">fs_get_time()</a> function is not implemented in the user application (which is the default), predefined time and date stamps are used.</p>
<h1><a class="anchor" id="fat_sys_design_limitations"></a>
FAT System Design Limitations</h1>
<p>By design, FAT carries a few limitations:</p><ul>
<li>Maximum file size is limited to 4,294,967,295 bytes</li>
<li>Maximum files within folder is 65,536 (i.e. a directory must not be larger than 2,097,152 bytes).</li>
<li>A root directory on FAT12 and FAT16 can hold max 512 files/folders (there is no such limitation for FAT32)</li>
<li>FAT type depends on maximum and minimum number of clusters:<ul>
<li>FAT12 maximum clusters: 4,084</li>
<li>FAT16 minimum clusters: 4,085</li>
<li>FAT16 maximum clusters: 65,524</li>
<li>FAT32 minimum clusters: 65,525</li>
</ul>
</li>
<li>Maximum volume size depends on FAT type:<ul>
<li>FAT12: 256MB (for 64kB clusters)</li>
<li>FAT16: 4GB (for 64kB clusters)</li>
<li>FAT32: 2TB (4G of 512B sectors)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="fat_imp_limitations"></a>
FAT Implementation Limitations</h1>
<p>The actual FAT implementation of the File System Component has the following limitations:</p><ul>
<li>Multiple partitions are not supported and will not be detected</li>
<li>Multiple active file handles per file are allowed only for files opened in read mode.</li>
<li>Maximum path length is 260 bytes for FAT with LFN support and 80 bytes for FAT without LFN support.</li>
<li>Seeking within files is limited to the area of two gigabytes due to the <a class="el" href="group__stdio__routines.html#ga800ee8381f5cce368abe5df835aa107c">fseek</a> and <a class="el" href="group__stdio__routines.html#ga6273f71322efc95f429d9e990a8ef8ae">ftell</a> limitation set by ANSI C Standard library</li>
<li>UTF-16 and UTF-8 character encoding is not supported </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
