<!-- HTML header for doxygen 1.9.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>File System Component: Resource Requirements</title>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="tabs.js"></script>
<script type="text/javascript" src="footer.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="URL_keys.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="extra_stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="extra_navtree.css" rel="stylesheet" type="text/css"/>
<link href="extra_search.css" rel="stylesheet" type="text/css"/>
<link href="extra_tabs.css" rel="stylesheet" type="text/css"/>
<link href="version.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../version.js"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 55px;">
  <td id="projectlogo" style="padding: 1.5em;"><img alt="Logo" src="armkeil_white_h.png"/></td>
  <td style="padding-left: 1em; padding-bottom: 1em;padding-top: 1em;">
   <div id="projectname">File System Component
   &#160;<span id="projectnumber"><script type="text/javascript">
     <!--
     writeHeader.call(this);
     writeVersionDropdown.call(this, "File System Component");
     //-->
    </script>
   </span>
   </div>
   <div id="projectbrief">MDK Middleware for Devices with Flash File System</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="CMSISnav" class="tabs1">
  <ul class="tablist">
    <script type="text/javascript">
      writeComponentTabs.call(this);
    </script>
  </ul>
</div>
<script type="text/javascript">
  writeSubComponentTabs.call(this);
</script>
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('resource_requirements.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Resource Requirements </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_src_resource_requirements"></a> This section describes the resource requirements of the <b>File System</b> component. The actual requirements depend on the features used in the application. Therefore, the numbers provided here are guidelines only and the actual numbers may differ.</p>
<h1><a class="anchor" id="fs_stack_req"></a>
Stack Requirements</h1>
<p>The File System component receives events sent from the interrupt service routine (ISR) of the drivers of the different drives. The stack requirements for the ISR are typically less than 512 Bytes.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Option (under section Stack Configuration)   </th><th class="markdownTableHeadLeft">Increase Value by    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Stack Size (in Bytes)   </td><td class="markdownTableBodyLeft">+ 512 for Driver of a Drive   </td></tr>
</table>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b></p>
<ul>
<li>Stack size for the ISRs is typically configured in the application <code>linker script</code> or device <code>startup_device.s</code>.</li>
<li>The stack size for the ISRs configures only the stack space that is used by exception and interrupt service routines of the drivers. The stack size requirements depend on the maximum nesting of exception and ISR execution and therefore on the priority settings of the various interrupt and exception sources. The stack size of the thread that calls FileSystem API function is configured in configuration file specific to the CMSIS-RTOS2 in use.</li>
<li>If you have multiple drives configured in your system with the same interrupt priority, you only need to add the stack of the drive with the largest requirement. If you have drives with nested interrupts (different priorities), you need to add the sum of all stack requirements. </li>
</ul>
</blockquote>
<h1><a class="anchor" id="fs_heap_req"></a>
Heap Requirements</h1>
<p>Heap is used by the standard C library memory allocation functions. The amount of heap required therefore depends on the toolchain used to build the application image. The table below shows the heap requirements per simultaneously opened file. If you wish to have three files open simultaneously, the value from the table must be multiplied by three.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Toolchain   </th><th class="markdownTableHeadLeft">Increase Value by    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Arm Compiler 6   </td><td class="markdownTableBodyLeft">+ (512 + 96) for each open file    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">GCC   </td><td class="markdownTableBodyLeft">+ (1024 + 64) for each open file   </td></tr>
</table>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b></p>
<p>Heap is used to hold the file descriptor and file data buffer. The size of data buffer can be changed with function <code>setvbuf</code> which is part of the standard C library. </p>
</blockquote>
<h1><a class="anchor" id="fs_rtos_req"></a>
CMSIS-RTOS Requirements</h1>
<h2><a class="anchor" id="autotoc_md13"></a>
Thread Stack Requirements</h2>
<p>Although the File System component requires a CMSIS-RTOS to be present, it is not creating any additional threads. Stack consumption depends greatly on the compiler optimization level. The table below shows approximate stack size required by the FileSystem functions when compiled for production ready application with high optimization level. For debugging purposes, with low or disabled optimization, the stack value should be increased.</p>
<table class="doxtable" summary="Memory Requirements">
<tr>
<th>Drive Type </th><th align="left">Value  </th></tr>
<tr>
<td align="center">RAM </td><td>min. 0.6 kBytes  </td></tr>
<tr>
<td align="center">MCI </td><td>min. 0.7 kBytes + MCI Driver  </td></tr>
<tr>
<td align="center">NAND </td><td>min. 1.3 kBytes + NAND Driver  </td></tr>
<tr>
<td align="center">NOR </td><td>min. 0.4 kBytes + Flash Driver  </td></tr>
<tr>
<td align="center">USB </td><td>min. 1.1 kBytes + USB Driver  </td></tr>
</table>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b></p>
<ul>
<li>The stack in bytes stated is required to work with the files from top level functions like fopen, fclose, â€¦, fdelete, frename and so on.</li>
<li>The drivers for the different types of drives require additional stack. This differs from device to device, but in general the stack usage for MCI, NAND, and Flash should not exceed additional 256 bytes. For USB drive, refer to  <script>link_ext('USB-Resource-Req');</script> for details.</li>
<li>If your application supports a combination of multiple drives, you need to configure your system to the the combined stack size for the sum of all drives. </li>
</ul>
</blockquote>
<h2><a class="anchor" id="autotoc_md14"></a>
Mutex Requirements</h2>
<p>Additionally, you may also need to adjust the memory used to allocate mutex objects required by the C stdio library. Depending on the toolchain used, the total number of mutex objects required for proper operation may differ, but in general every active file stream requires a mutex object.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b></p>
<ul>
<li>Arm Standard C Library and GCC Newlib require the following mutexes: 2 (internal stdio operations) + 3 (stdin, stdout and stderr file streams) + 1 for each active file stream</li>
<li><a href="https://github.com/ARM-software/CMSIS-Compiler">CMSIS-Compiler</a> provides software component <code>OS Interface:CMSIS-RTOS2</code> that implements multithreading support across different toolchains when using CMSIS-RTOS2. It shall be used when file operation functions get called from multiple threads. </li>
</ul>
</blockquote>
<h1><a class="anchor" id="fs_spec_mem_req"></a>
Memory Requirements</h1>
<p>The following table shows the memory requirements for read-only (Flash) and read-write (RAM) memory. These numbers may be used to estimate the total size requirements of the application, but the actual numbers depend on compiler optimizations and target processor and may be therefore slightly different.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Component   </th><th class="markdownTableHeadCenter">RO Memory [Bytes]   </th><th class="markdownTableHeadLeft">RW Memory (Data) [Bytes]    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>C stdio Library</b>   </td><td class="markdownTableBodyCenter">&lt; 5.0 k   </td><td class="markdownTableBodyLeft">&lt; 0.3 k    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Core</b> Common   </td><td class="markdownTableBodyCenter">&lt; 3.5 k   </td><td class="markdownTableBodyLeft">0    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>File System:Core</b> EFS (Embedded File System)   </td><td class="markdownTableBodyCenter">&lt; 6.0 k   </td><td class="markdownTableBodyLeft">&lt; 0.4 k    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Core</b> FAT with SFN (Short File Name)   </td><td class="markdownTableBodyCenter">&lt; 13.0 k   </td><td class="markdownTableBodyLeft">1.2 k    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>File System:Core</b> FAT with LFN (Long File Name)   </td><td class="markdownTableBodyCenter">&lt; 14.4 k   </td><td class="markdownTableBodyLeft">1.2 k    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Core</b> FAT Name caching   </td><td class="markdownTableBodyCenter">1.6 k   </td><td class="markdownTableBodyLeft">48 x <em>FAT Name Cache Size</em> (configured in <code>FS_Config_Drive_n.h</code>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>File System:Core</b> FAT Journaling   </td><td class="markdownTableBodyCenter">0.7 k   </td><td class="markdownTableBodyLeft">0.5 k (configured in <code>FS_Config_Drive_n.h</code>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Drive:Memory Card</b> (FAT)   </td><td class="markdownTableBodyCenter">2.7 k   </td><td class="markdownTableBodyLeft">&lt; 0.2 k + <em>Drive Cache Size</em> (configured in <code>FS_Config_MC_n.h</code>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>File System:Drive:NAND</b> (FAT)   </td><td class="markdownTableBodyCenter">&lt; 10.6 k   </td><td class="markdownTableBodyLeft">&lt; 0.7 k + <em>Drive Cache Size</em> + <em>Page Caching</em> + <em>Block Indexing</em> (configured in <code>FS_Config_NAND_n.h</code>)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Drive:NOR</b> (EFS)   </td><td class="markdownTableBodyCenter">&lt; 0.1 k   </td><td class="markdownTableBodyLeft">&lt; 0.1 k    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>File System:Drive:RAM</b> (FAT)   </td><td class="markdownTableBodyCenter">&lt; 0.2 k   </td><td class="markdownTableBodyLeft">&lt; 0.2 k    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>File System:Drive:USB</b> (FAT)   </td><td class="markdownTableBodyCenter">&lt; 0.6 k   </td><td class="markdownTableBodyLeft">&lt; 0.2 k + <em>Drive Cache Size</em> (configured in <code>FS_Config_USB_n.h</code>)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>MCI Driver</b>   </td><td class="markdownTableBodyCenter">1 .. 4 k   </td><td class="markdownTableBodyLeft">0.1 .. 2 k    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>NAND Driver</b>   </td><td class="markdownTableBodyCenter">0.5 .. 4 k   </td><td class="markdownTableBodyLeft">0.1 .. 4 k    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Flash Driver</b>   </td><td class="markdownTableBodyCenter">&lt; 2 k   </td><td class="markdownTableBodyLeft">&lt; 0.1 k   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <script type="text/javascript">
        <!--
        writeFooter.call(this);
        //-->
      </script> 
    </li>
  </ul>
</div>
</body>
</html>
